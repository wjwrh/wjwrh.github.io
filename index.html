<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.go2mc.net","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Ruby&#39;s Blog">
<meta property="og:url" content="https://blog.go2mc.net/index.html">
<meta property="og:site_name" content="Ruby&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Ruby">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.go2mc.net/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Ruby's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ruby's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">In solitude, where we are least alone.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/wjwrh" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2023/02/15/DeployBlogs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/15/DeployBlogs/" class="post-title-link" itemprop="url">æŠŠåšå®¢é‡æ–°æ”¯æ¥èµ·æ¥</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-02-15 11:00:10" itemprop="dateCreated datePublished" datetime="2023-02-15T11:00:10+00:00">2023-02-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-02-16 11:39:37" itemprop="dateModified" datetime="2023-02-16T11:39:37+00:00">2023-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Misc/" itemprop="url" rel="index"><span itemprop="name">Misc</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ç”¨Hexoä¸GithubActionæ­å»ºè‡ªåŠ¨éƒ¨ç½²åšå®¢"><a href="#ç”¨Hexoä¸GithubActionæ­å»ºè‡ªåŠ¨éƒ¨ç½²åšå®¢" class="headerlink" title="ç”¨Hexoä¸GithubActionæ­å»ºè‡ªåŠ¨éƒ¨ç½²åšå®¢"></a>ç”¨Hexoä¸GithubActionæ­å»ºè‡ªåŠ¨éƒ¨ç½²åšå®¢</h1><p>ä¹‹å‰çš„åšå®¢åºŸå¼ƒå·²ä¹…ï¼Œhexoä¹Ÿæ˜¯ä¸Šå¤ç‰ˆæœ¬ï¼Œå„ç§é…ç½®ä¹Ÿéå¸¸æŠ½è±¡ï¼Œæœ€è¿‘è£…äº†archï¼Œæ‰“ç®—åœ¨archä¸Šé‡æ–°æŠŠåšå®¢æ­èµ·æ¥ã€‚åŒæ—¶ï¼ŒåŸæ¥çš„åšå®¢æ˜¯ç”¨hexo-deployer-gitç›´æ¥éƒ¨ç½²åˆ°github pageçš„ï¼Œåšå®¢çš„æºä»£ç å¹¶æ²¡æœ‰æ¨åˆ°githubä¸Šï¼Œè¿™å¯¼è‡´åœ¨å¤šä¸ªç”µè„‘ä¹‹é—´å¾ˆéš¾åŒæ­¥åšå®¢çŠ¶æ€(ğŸ‘´ğŸ»ä¹‹å‰QQä¼ å‹ç¼©åŒ…åŒæ­¥çœŸçš„8å¤ªè¡Œ)</p>
<blockquote>
<p>Edit: è¡¥å……ä¸€ç‚¹ï¼Œä¹‹å‰é‚£æ ·éœ€è¦åœ¨æ¯å°ç”µè„‘ä¸Šå®‰è£…npmï¼Œæœ¬åœ°ç¼–è¯‘ç„¶åæ¨ï¼Œæ”¹æˆGithub Actionåæœ¬åœ°ç”šè‡³ä¸ç”¨è£…hexoå°±èƒ½éƒ¨ç½²(é€ƒ</p>
</blockquote>
<p>äºæ˜¯æˆ‘èŠ±è´¹ä¸€æ™šå®Œæˆäº†ä¸‹åˆ—å·¥ä½œ</p>
<ul>
<li>é‡æ–°åœ¨æœ¬åœ°æ•´äº†ä¸€å¥—hexoå¹¶ä¸”æŠŠæ—§blogçš„æ–‡ç« è¿ç§»è¿‡æ¥</li>
<li>å®ŒæˆåŸºæœ¬çš„ä¸»é¢˜å’Œæ’ä»¶é…ç½®</li>
<li>å°†åšå®¢æºç æ¨åˆ°ç§æœ‰ä»“åº“ä¸­</li>
<li>ä½¿ç”¨GithubActionè‡ªåŠ¨éƒ¨ç½²åˆ°GithubPage</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/02/15/DeployBlogs/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2023/02/05/Rustlings/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/05/Rustlings/" class="post-title-link" itemprop="url">Rustlingséšè®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-02-05 12:11:48" itemprop="dateCreated datePublished" datetime="2023-02-05T12:11:48+00:00">2023-02-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-02-16 11:39:37" itemprop="dateModified" datetime="2023-02-16T11:39:37+00:00">2023-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming-Language/" itemprop="url" rel="index"><span itemprop="name">Programming Language</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Rustlingséšè®°"><a href="#Rustlingséšè®°" class="headerlink" title="Rustlingséšè®°"></a>Rustlingséšè®°</h1><p>çœ‹å®Œäº†Rustå…¥é—¨ä¹¦ç±<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/book/">ã€ŠThe Rust Programming Languageã€‹</a>ï¼Œå‘ç°å®˜æ–¹è¿˜æä¾›äº†ä¸€ä¸ªç”±å°ç»ƒä¹ æ„æˆçš„é¡¹ç›®<a target="_blank" rel="noopener" href="https://github.com/rust-lang/rustlings/">rustlings</a>ï¼Œäºæ˜¯æ‹¿æ¥ç»ƒç»ƒæ‰‹ã€‚å¤§éƒ¨åˆ†å†…å®¹éƒ½æ¯”è¾ƒç®€å•ï¼Œçœ‹è¿‡ä¸€éä¹¦çš„è¯åº”è¯¥éƒ½èƒ½å¾ˆå®¹æ˜“åšå‡ºæ¥ï¼Œè¿™é‡Œåªè®°å½•ä¸€äº›æˆ‘è§‰å¾—æœ‰æ„æ€çš„ä¸œè¥¿</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/02/05/Rustlings/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2023/02/04/RustAssociatedTypes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/04/RustAssociatedTypes/" class="post-title-link" itemprop="url">Associated Types & Generics</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2023-02-04 20:25:37" itemprop="dateCreated datePublished" datetime="2023-02-04T20:25:37+00:00">2023-02-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2023-02-16 11:39:37" itemprop="dateModified" datetime="2023-02-16T11:39:37+00:00">2023-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming-Language/" itemprop="url" rel="index"><span itemprop="name">Programming Language</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Associated-Types-amp-Generics"><a href="#Associated-Types-amp-Generics" class="headerlink" title="Associated Types &amp; Generics"></a>Associated Types &amp; Generics</h1><p>Rustä¸­æœ‰ä¸€ä¸ªæ¦‚å¿µå«åš<code>Associated Types</code>ï¼Œèƒ½å¤Ÿåœ¨traitä¸­å…³è”ä¸€ä¸ªç±»å‹ï¼ŒåŠŸèƒ½ç±»ä¼¼äº<code>Generics</code>ï¼Œæœ€ä¸»è¦åº”ç”¨å°±æ˜¯<code>Iterator</code>ï¼Œå…·ä½“ç”¨ä¾‹å¦‚ä¸‹</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">trait</span> <span class="title class_">Iterator</span> &#123;</span><br><span class="line">    <span class="keyword">type</span> <span class="title class_">Item</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">next</span>(&amp;<span class="keyword">mut</span> <span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;<span class="keyword">Self</span>::Item&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€çœ¼åœ¨rust bookçœ‹åˆ°è¿™ä¸œè¥¿çš„æ—¶å€™æ„Ÿè§‰å°±è·Ÿæ³›å‹æŒºåƒçš„ï¼Œå¹¶ä¸”ä¹¦åœ¨éšåä¹Ÿè¯´æ˜äº†ä¸æ³›å‹çš„åŒºåˆ«ï¼Œå‡­å€ŸğŸ‘´ğŸ»æŠ½è±¡çš„è‹±è¯­æ°´å¹³ç£•ç£•ç»Šç»Šçš„è¯»å®Œäº†<a target="_blank" rel="noopener" href="https://doc.rust-lang.org/book/ch19-03-advanced-traits.html#specifying-placeholder-types-in-trait-definitions-with-associated-types">ä¸€å¤§æ®µæè¿°</a>åæœ‰äº†ä¸€å®šçš„ç†è§£ï¼Œé‚è®°å½•ä¸‹æ¥</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2023/02/04/RustAssociatedTypes/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2022/12/05/RustNote/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/05/RustNote/" class="post-title-link" itemprop="url">Rustå­¦ä¹ æ‚è®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-12-05 14:40:48" itemprop="dateCreated datePublished" datetime="2022-12-05T14:40:48+00:00">2022-12-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming-Language/" itemprop="url" rel="index"><span itemprop="name">Programming Language</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>è¿™æ˜¯åˆšåˆšå¼€å§‹å­¦Rustæ—¶è®°å½•çš„ï¼Œå•¥éƒ½ç»™è®°ä¸‹æ¥äº†ï¼Œåæ¥æ„Ÿè§‰è¿™ç§ç¬”è®°ç‚¹å¤ªå¤šï¼Œå¾ˆæ‚å¾ˆåï¼Œéƒ½ä¸ä¸€å®šç”¨å¾—åˆ°ï¼Œå­¦ä¹ æ•ˆç‡å¾ˆä½ï¼Œä¸å¦‚æœ‰éœ€è¦çš„æ—¶å€™å†æŸ¥ã€‚äºæ˜¯åé¢åŠæœ¬ä¹¦å°±æ²¡è®°äº†</p>
</blockquote>
<h1 id="Rust-learning-note"><a href="#Rust-learning-note" class="headerlink" title="Rust-learning note"></a>Rust-learning note</h1><h2 id="1-Getting-Started"><a href="#1-Getting-Started" class="headerlink" title="1. Getting Started"></a>1. Getting Started</h2><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>Windowsä¸‹rustup-initä¸€æŠŠæ¢­ï¼Œæ²¡ç¢°åˆ°ä»€ä¹ˆé—®é¢˜</p>
<p>åæœŸå¯ä»¥ç›´æ¥ä½¿ç”¨æŒ‡ä»¤<code>rustup update</code>å‡çº§</p>
<h3 id="Cargo"><a href="#Cargo" class="headerlink" title="Cargo"></a>Cargo</h3><p>Rustæ˜¯ç¼–è¯‘å‹è¯­è¨€ï¼Œå®˜æ–¹æä¾›äº†ä¸€ä¸ªåä¸ºCargoçš„å·¥å…·ç”¨äºç®¡ç†é¡¹ç›®(ä¸ªäººæ„Ÿè§‰è·Ÿgradleå¯èƒ½æœ‰ç‚¹åƒ?åˆšå­¦è¿˜ä¸å¤ªæ¸…æ¥šxd)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cargo new &lt;name&gt;     	 # åŒæ—¶è¿˜ä¼šæ–°å»ºåŒågitä»“åº“</span><br><span class="line">cargo build         	 # ç¼–è¯‘é¡¹ç›®</span><br><span class="line">cargo run           	 # è¿è¡Œé¡¹ç›®</span><br><span class="line">cargo check         	 # æ£€æŸ¥é¡¹ç›®æ˜¯å¦å¯ä»¥ç¼–è¯‘ï¼ŒèŠ‚çœç¼–è¯‘æ—¶é—´</span><br><span class="line">cargo doc --open   		 # ç¼–è¯‘å¹¶æ‰“å¼€å½“å‰æ‰€æœ‰ä¾èµ–æ„æˆçš„doc</span><br><span class="line">cargo new &lt;name&gt; --lib 	 #æ–°å»ºåº“package</span><br></pre></td></tr></table></figure>

<p><code>build</code>é»˜è®¤æ˜¯ç¼–è¯‘debugç‰ˆæœ¬ï¼Œä½¿ç”¨å‚æ•°â€“releaseå¯ä»¥ç¼–è¯‘å‘è¡Œç‰ˆ</p>
<h2 id="2-Programming-a-Guessing-Game"><a href="#2-Programming-a-Guessing-Game" class="headerlink" title="2. Programming a Guessing Game"></a>2. Programming a Guessing Game</h2><p>æœ¬ç« èŠ‚ä»¥ä¸€ä¸ªçŒœæ•°å­—ç¨‹åºä¸ºä¾‹ä»‹ç»äº†å„ä¸ªæ–¹é¢çš„åŸºç¡€çŸ¥è¯†ç‚¹ï¼Œå†…å®¹æ¯”è¾ƒæ‚æ¯”è¾ƒæµ…æ˜¾</p>
<h3 id="å˜é‡å’Œå¼•ç”¨"><a href="#å˜é‡å’Œå¼•ç”¨" class="headerlink" title="å˜é‡å’Œå¼•ç”¨"></a>å˜é‡å’Œå¼•ç”¨</h3><p>Rustä¸­ä½¿ç”¨<code>let</code>å…³é”®å­—åˆ›å»ºå˜é‡ï¼Œé»˜è®¤æƒ…å†µä¸‹Rustçš„å˜é‡æ˜¯<strong>ä¸å¯å˜</strong>çš„ï¼Œæƒ³è¦åˆ›å»ºå¯å˜å˜é‡éœ€è¦æ·»åŠ å•Šå…³é”®å­—<code>mut</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">apple</span> = <span class="number">5</span>;</span><br><span class="line">lete <span class="keyword">mut</span> bananas = <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>åœ¨ç»™å‡½æ•°ä¼ å‚æ—¶ä½¿ç”¨&amp;ç¬¦å·å³å¯ä¼ é€’å¼•ç”¨ï¼Œé»˜è®¤æƒ…å†µä¸‹å¼•ç”¨ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œéœ€è¦ä½¿ç”¨<code>mut</code>å…³é”®å­—è·å–å¯å˜å¼•ç”¨</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">io::<span class="title function_ invoke__">stdin</span>()</span><br><span class="line">    .<span class="title function_ invoke__">read_line</span>(&amp;<span class="keyword">mut</span> guess)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç–‘é—®ï¼šå¦‚æœä»¥å¯å˜å¼•ç”¨å¼•ç”¨ä¸å¯å˜å˜é‡ä¼šå¦‚ä½•ï¼Ÿ<br>ç­”ï¼šå¾ˆæ˜æ˜¾ä¼šæŠ¥é”™ã€‚ã€‚</p>
</blockquote>
<h3 id="åŸºæœ¬é”™è¯¯å¤„ç†"><a href="#åŸºæœ¬é”™è¯¯å¤„ç†" class="headerlink" title="åŸºæœ¬é”™è¯¯å¤„ç†"></a>åŸºæœ¬é”™è¯¯å¤„ç†</h3><p><code>read_line</code>ä¼šè¿”å›ä¸€ä¸ª<code>Result</code>ç±»å‹çš„å€¼ï¼Œ<code>Result</code>å€¼å¯èƒ½ä¸º<code>Ok</code>æˆ–è€…<code>Err</code><br>å¦‚æœæƒ³åœ¨é‡åˆ°<code>Err</code>æ—¶ä¸åšå¤„ç†ç®€å•çš„ç»ˆæ­¢ç¨‹åºï¼Œå¯ä»¥è°ƒç”¨<code>Result</code>çš„æ–¹æ³•<code>expect</code><br>å¦‚æœå¯¹äºä¸€ä¸ªå¯èƒ½å‡ºé”™çš„<code>Result</code>ä¸åšä»»ä½•å¤„ç†ï¼Œç¼–è¯‘å™¨ä¼šå‘å‡ºè­¦å‘Š</p>
<h3 id="ä¾èµ–å¼•å…¥ä¸ä¾èµ–ç‰ˆæœ¬"><a href="#ä¾èµ–å¼•å…¥ä¸ä¾èµ–ç‰ˆæœ¬" class="headerlink" title="ä¾èµ–å¼•å…¥ä¸ä¾èµ–ç‰ˆæœ¬"></a>ä¾èµ–å¼•å…¥ä¸ä¾èµ–ç‰ˆæœ¬</h3><p>Cargoç†è§£<a target="_blank" rel="noopener" href="http://semver.org/">è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒ</a>ï¼Œåœ¨0.x.yçš„å¼€å‘é˜¶æ®µï¼Œxç›¸åŒä½†yä¸åŒçš„ä¾èµ–ç†åº”å¯ä»¥å…±ç”¨ï¼Œå› æ­¤cargoä¼šä½¿ç”¨xç›¸åŒä½†yå°½é‡å¤§çš„ä¾èµ–åº“<br>ä¾‹å¦‚å½“å‰æœ€æ–°ç‰ˆæœ¬çš„<code>rand</code>ä¸º0.8.5ï¼Œä½¿ç”¨<code>rand = &quot;0.8.3&quot;</code>ä¼šå¼•å…¥0.8.5ç‰ˆæœ¬çš„<code>rand</code><br><img src="/2022/12/05/RustNote/../.note_assest/Code_pM3vpcgVbg.png"></p>
<p>ä¸ºäº†ä¿è¯å®Œå…¨ä¸€è‡´çš„ç‰¹æ€§ï¼ŒCargoä½¿ç”¨Cargo.lockæ¥ç¡®ä¿ç¬¬ä¸€æ¬¡buildä¹‹åçš„æ‰€æœ‰buildä½¿ç”¨ç›¸åŒç‰ˆæœ¬çš„ä¾èµ–ï¼Œä¾‹å¦‚</p>
<ul>
<li>åœ¨åˆå§‹æ—¶cargo.lockä¸ºç©ºï¼Œåœ¨ç¼–è¯‘æ—¶randæœ€æ–°ç‰ˆæœ¬ä¸º0.8.5ï¼Œé…ç½®æ–‡ä»¶æŒ‡å®šç‰ˆæœ¬0.8.3ï¼Œåˆ™é¦–æ¬¡æ‰§è¡Œcargo buildä¼šæ‹‰å–0.8.5ç‰ˆæœ¬çš„randï¼Œcargoä¼šå°†randåŠå…¶ä¾èµ–çš„ç›¸å…³ä¿¡æ¯å†™å…¥lockæ–‡ä»¶</li>
<li>åç»­å‡ºç°äº†ç‰ˆæœ¬0.8.6åï¼Œé‡æ–°buildæ­¤é¡¹ç›®ï¼Œcargoä¼šæ£€æŸ¥lockæ–‡ä»¶ï¼Œå‘ç°æ­¤é¡¹ç›®é¦–æ¬¡ç¼–è¯‘ä½¿ç”¨0.8.5ï¼Œä¾¿ä¸ä¼šé‡‡ç”¨0.8.6ç‰ˆæœ¬ï¼Œè€Œæ˜¯ä½¿ç”¨0.8.5ç‰ˆæœ¬ç¼–è¯‘</li>
<li>å¦‚æœéœ€è¦å¼ºåˆ¶ä½¿ç”¨æœ€æ–°ä¿®è®¢å·çš„ä¾èµ–ï¼Œéœ€è¦ä½¿ç”¨<code>cargo update</code>æŒ‡ä»¤</li>
</ul>
<h3 id="match"><a href="#match" class="headerlink" title="match"></a>match</h3><p>ä¸ktçš„when statementç±»ä¼¼ï¼Œæ²¡æœ‰whené‚£ä¹ˆçµæ´»ï¼Œéœ€è¦coveråˆ°æ‰€æœ‰å¯èƒ½çš„ç»“æœï¼Œå¦åˆ™æŠ¥é”™</p>
<h3 id="é‡å®šä¹‰å˜é‡"><a href="#é‡å®šä¹‰å˜é‡" class="headerlink" title="é‡å®šä¹‰å˜é‡"></a>é‡å®šä¹‰å˜é‡</h3><p>rustå¯ä»¥ä»¥ç›¸åŒçš„åå­—é‡å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œè¿™é€šå¸¸åœ¨éœ€è¦è½¬æ¢å˜é‡ç±»å‹æ—¶ç”¨åˆ°</p>
<h2 id="3-Common-Pogramming-Concepts"><a href="#3-Common-Pogramming-Concepts" class="headerlink" title="3. Common Pogramming Concepts"></a>3. Common Pogramming Concepts</h2><p>constå…³é”®å­—å¯ä»¥å£°æ˜å¸¸é‡ï¼Œä¸letçš„åŒºåˆ«æ˜¯</p>
<ul>
<li>constå¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸä½¿ç”¨ï¼ŒåŒ…æ‹¬å…¨å±€ä½œç”¨åŸŸ</li>
<li>constçš„å€¼åªèƒ½è®¾ç½®ä¸ºä¸€ä¸ªå¸¸é‡è¡¨è¾¾å¼ï¼Œä¸èƒ½æ˜¯åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®è®¤çš„å€¼</li>
<li>å¯ä»¥å¯¹constæ‰§è¡Œå¯å˜å¼•ç”¨ï¼Œä½†æ˜¯å¼•ç”¨æŒ‡å‘constçš„å‰¯æœ¬ï¼Œä¸ä¼šå½±å“åŸæœ‰å€¼ï¼›å¯¹æ™®é€šä¸å˜é‡è¿›è¡Œå¯å˜å¼•ç”¨æ— æ³•é€šè¿‡ç¼–è¯‘</li>
</ul>
<p>debugæ¨¡å¼ä¸‹æ•´å‹æº¢å‡ºä¼šå¯¼è‡´panicï¼Œreleaseä¸ä¼š  </p>
<p>charä¸º4å­—èŠ‚  </p>
<p>rustæ”¯æŒå…ƒç»„(tuple)ï¼Œæ²¡æœ‰å…ƒç´ çš„å…ƒç»„ç§°ä¸ºunitï¼›æ²¡æœ‰è¿”å›å€¼çš„è¡¨è¾¾å¼éšå¼çš„è¿”å›unit  </p>
<p>Rustä¸­æ•°ç»„é•¿åº¦ä¸å¯å˜ï¼Œvectoré•¿åº¦å¯å˜ï¼Œåœ¨ç¡®è®¤æ•°ç»„å…ƒç´ çš„æ•°é‡ä¸å˜æ—¶ä½¿ç”¨æ•°ç»„æ›´å¥½ï¼Œæ•°ç»„å£°æ˜æ–¹å¼ï¼š</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">a</span>: [<span class="type">i32</span>; <span class="number">5</span>] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];  <span class="comment">//æŒ‡å®šæ•°æ®ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">a</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> <span class="variable">a</span> = [<span class="number">3</span>; <span class="number">5</span>];                     <span class="comment">//ç­‰ä»·äºlet a = [3, 3, 3, 3, 3];</span></span><br></pre></td></tr></table></figure>

<h3 id="Expression-amp-Statement"><a href="#Expression-amp-Statement" class="headerlink" title="Expression &amp; Statement"></a>Expression &amp; Statement</h3><p>å‡½æ•°è°ƒç”¨ã€å¤§æ‹¬å·å¼€å§‹çš„æ–°scopeã€macroè°ƒç”¨éƒ½å±äºexpression</p>
<ul>
<li>å¤§æ‹¬å·expressionçš„è®¡ç®—å€¼æ˜¯å¤§æ‹¬å·é‡Œæœ€åä¸€è¡Œçš„å€¼<ul>
<li>åœ¨å¤§æ‹¬å·å†…æœ€åä¸€è¡Œå¦‚æœæ˜¯statementï¼Œåˆ™expressionçš„å€¼ä¸º<code>()</code></li>
</ul>
</li>
<li>expressionæ‰“ä¸Šåˆ†å·å°†ä¼šè½¬åŒ–ä¸ºstatement</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> condition &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>if elseç»“æ„å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªexpressionï¼Œå…¶å€¼ä¸ºå®é™…æ‰§è¡Œçš„scopeçš„å€¼ï¼Œå› æ­¤å¯ä»¥ç”¨äºletèµ‹å€¼</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">number</span> = <span class="keyword">if</span> condition &#123; <span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>; x + <span class="number">6</span> &#125; <span class="keyword">else</span> &#123; <span class="number">6</span> &#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§èµ‹å€¼è¦æ±‚if elseæ¯ä¸€ä¸ªåˆ†æ”¯expressionçš„è¿”å›ç±»å‹å¿…é¡»ç›¸åŒ  </p>
<h3 id="Rustä¸‰ç±»å¾ªç¯"><a href="#Rustä¸‰ç±»å¾ªç¯" class="headerlink" title="Rustä¸‰ç±»å¾ªç¯"></a>Rustä¸‰ç±»å¾ªç¯</h3><h4 id="loop"><a href="#loop" class="headerlink" title="loop"></a>loop</h4><p>loopå¾ªç¯å³æ— æ¡ä»¶å¾ªç¯ï¼Œé€šå¸¸åªèƒ½ä½¿ç”¨breakç ´é™¤å¾ªç¯ï¼Œæœ‰ä¸€äº›ç‰¹æ®Šçš„ç‰¹ç‚¹</p>
<ul>
<li>breakåå¯ä»¥æºå¸¦expressionï¼Œä½œä¸ºæ•´ä¸ªloopçš„è¾“å‡ºexpression</li>
<li>loopå¯ä»¥èµ‹äºˆç‰¹æ®Šçš„labelï¼Œåœ¨breakæ—¶å¯ä»¥æŒ‡å®šlabelæ¥ç»“æŸç‰¹å®šçš„å¾ªç¯ï¼Œä¾‹å¦‚ï¼š</li>
</ul>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="symbol">&#x27;counting_up</span>: <span class="keyword">loop</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;count = &#123;count&#125;&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">remaining</span> = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">loop</span> &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;remaining = &#123;remaining&#125;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> remaining == <span class="number">9</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> count == <span class="number">2</span> &#123;</span><br><span class="line">                <span class="keyword">break</span> <span class="symbol">&#x27;counting_up</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            remaining -= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        count += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;End count = &#123;count&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="while"><a href="#while" class="headerlink" title="while"></a>while</h4><p>whileå³æ¡ä»¶å¾ªç¯ï¼Œwhileæ— æ³•ä½¿ç”¨breakæºå¸¦ä¿¡æ¯</p>
<h4 id="for"><a href="#for" class="headerlink" title="for"></a>for</h4><p>forå³è¿­ä»£å¾ªç¯ï¼Œä¸pythonç±»ä¼¼ï¼Œ<code>for xxx in xxx</code></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯forå¾ªç¯å€Ÿç”¨çš„å¯¹è±¡å¯èƒ½ä¼šå‘ç”ŸMoveäº§ç”Ÿæ§åˆ¶æƒè½¬ç§»</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> v &#123;			<span class="comment">// move occured</span></span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print!</span>(<span class="string">&quot;&#123;:#?&#125;&quot;</span>, v);		<span class="comment">// invalid</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="4-Understanding-Owwnership"><a href="#4-Understanding-Owwnership" class="headerlink" title="4. Understanding Owwnership"></a>4. Understanding Owwnership</h2><h3 id="Ways-Variables-and-Data-Interact"><a href="#Ways-Variables-and-Data-Interact" class="headerlink" title="Ways Variables and Data Interact"></a>Ways Variables and Data Interact</h3><h4 id="Move"><a href="#Move" class="headerlink" title="Move"></a>Move</h4><p>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹çš„ä¼ é€’ï¼ŒRustä¸å…¶ä»–è¯­è¨€ç±»ä¼¼ï¼Œç›´æ¥å¤åˆ¶å€¼</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">5</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span> = x;</span><br></pre></td></tr></table></figure>

<p>xä¸yæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å˜é‡ï¼ŒæŒ‡å‘æ ˆä¸Šä¸åŒçš„ç©ºé—´</p>
<p>è€Œå¯¹äºå¼•ç”¨ç±»å‹çš„ä¼ é€’ï¼ŒRusté‡‡ç”¨<em>move</em>çš„å½¢åŠ¿å®ç°</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = s1;</span><br></pre></td></tr></table></figure>

<p>åœ¨å…¶å®ƒè¯­è¨€ä¸­ï¼Œs2ä¸s1å†…éƒ¨çš„æŒ‡é’ˆä¼šæŒ‡å‘åŒä¸€ç‰‡å†…å­˜åŒºåŸŸï¼Œè€Œåœ¨Rustä¸­ï¼Œs1ä¼šç›´æ¥å¤±æ•ˆï¼Œåªæœ‰s2æ‹¥æœ‰è¯¥ç‰‡å†…å­˜åŒºåŸŸçš„æ‰€æœ‰æƒ</p>
<h4 id="Clone"><a href="#Clone" class="headerlink" title="Clone"></a>Clone</h4><p>å¯¹äºå®ç°äº†<code>Copy trait</code>çš„ç±»å‹ï¼ˆåŸºæœ¬æ•°æ®ç±»å‹å®ç°äº†ï¼‰ï¼Œåœ¨å¤åˆ¶æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œæ·±å¤åˆ¶ï¼ŒåŒæ—¶å¤åˆ¶å‰åçš„å˜é‡éƒ½ä¸ä¼šå¤±æ•ˆ</p>
<p>å¦‚æœæƒ³è®©æ²¡æœ‰å®ç°copyçš„å¼•ç”¨ç±»å‹æ‰§è¡Œæ·±æ‹·è´ï¼Œéœ€è¦è°ƒç”¨<code>clone</code>æ–¹æ³•</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå‡½æ•°å‚æ•°çš„ä¼ é€’ä»¥åŠå‚æ•°çš„è¿”å›éƒ½æœ‰ç±»ä¼¼çš„è¡Œä¸ºï¼Œå®ç°äº†Copyçš„è¿›è¡Œæ·±å¤åˆ¶ï¼Œæ²¡æœ‰å®ç°çš„ä¼šå‘ç”ŸMove</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">take_owner</span>(s);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;s&#125;&quot;</span>);    <span class="comment">// åŸæœ¬å†…å­˜åŒºåŸŸçš„owneræƒè½¬ç§»èµ°äº†ï¼Œså¤±æ•ˆ</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">take_owner</span>(s: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;s&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="References-and-Borrowing"><a href="#References-and-Borrowing" class="headerlink" title="References and Borrowing"></a>References and Borrowing</h3><p>ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œé¿å…ä¼ å‚ç­‰æƒ…å†µå¯¼è‡´çš„owneræƒé™ä¸¢å¤±ï¼Œå¯ä»¥ä¼ é€’å‚æ•°çš„å¼•ç”¨</p>
<p>å‡½æ•°å‚æ•°å¿…é¡»è¦å£°æ˜å…¶æ¥å—å¼•ç”¨ï¼Œè°ƒç”¨æ—¶ä¹Ÿå¿…é¡»ä½¿ç”¨&amp;ç¬¦å·è·å–å¼•ç”¨å¹¶ä¼ é€’</p>
<p>å¦‚æœåŸå˜é‡æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥è·å–å…¶å¯å˜å¼•ç”¨ï¼Œä½†æ˜¯å¦‚æœåŒä¸€ä¸ªscopeä¸­å·²ç»æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨å‡ºç°ï¼Œåˆ™è¯¥å˜é‡ä¸èƒ½å†æœ‰å…¶ä»–çš„å¼•ç”¨</p>
<p>å‡†ç¡®æ¥è¯´æ˜¯ï¼Œå¦‚æœä¸€æ¬¡å¯å˜å€Ÿç”¨å‘ç”Ÿäº†ï¼Œé‚£ä¹ˆåœ¨æ­¤æ¬¡å¯å˜å€Ÿç”¨å‘ç”Ÿä¹‹å‰çš„ä»»ä½•å€Ÿç”¨ä¸èƒ½å†ä½¿ç”¨</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;hellowrold&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">inmut_ref</span> = &amp;s;</span><br><span class="line">   <span class="keyword">let</span> <span class="variable">mut_ref1</span> = &amp;<span class="keyword">mut</span> s;</span><br><span class="line">   <span class="keyword">let</span> <span class="variable">mut_ref2</span> = &amp;<span class="keyword">mut</span> s;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§å€Ÿç”¨æ˜¯å¯ä»¥å‘ç”Ÿçš„ï¼Œä½†æ˜¯åœ¨<code>mut_ref2</code>ä¹‹åå°±ä¸èƒ½å†ä½¿ç”¨<code>inmut_refå’Œmut_ref1</code>äº†</p>
<p>æ­¤å¤–Rustç¼–è¯‘å™¨ç¡®ä¿ä¸ä¼šå‡ºç°æ‚¬å‚å¼•ç”¨çš„æƒ…å†µ</p>
<h3 id="The-Slice-Type"><a href="#The-Slice-Type" class="headerlink" title="The Slice Type"></a>The Slice Type</h3><p>String sliceæ˜¯ä¸€ç§å¯¹äºæŸä¸ªStringçš„ç‰¹æ®Šçš„å¼•ç”¨ï¼Œå…¶ç±»å‹ä¸º<code>&amp;str</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello, World!&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">slice</span>: &amp;<span class="type">str</span> = &amp;s[<span class="number">3</span>..<span class="number">5</span>];</span><br></pre></td></tr></table></figure>



<h2 id="5-Using-Structs-to-Structuree-Related-Data"><a href="#5-Using-Structs-to-Structuree-Related-Data" class="headerlink" title="5. Using Structs to Structuree Related Data"></a>5. Using Structs to Structuree Related Data</h2><p>Rustç»“æ„ä½“çš„å®šä¹‰æ–¹å¼ä¸åˆ«çš„è¯­è¨€ç±»ä¼¼ï¼Œåœ¨ä½¿ç”¨ä¸Šä¸åˆ«çš„æœ‰ä»¥ä¸‹ç‰¹ç‚¹</p>
<h3 id="ç»“æ„ä½“åˆå§‹åŒ–"><a href="#ç»“æ„ä½“åˆå§‹åŒ–" class="headerlink" title="ç»“æ„ä½“åˆå§‹åŒ–"></a>ç»“æ„ä½“åˆå§‹åŒ–</h3><p>åˆå§‹åŒ–æ—¶å¯ä»¥ç®€åŒ–ä¸å­—æ®µåŒåçš„å˜é‡</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    active: <span class="type">bool</span>,</span><br><span class="line">    username: <span class="type">String</span>,</span><br><span class="line">    email: <span class="type">String</span>,</span><br><span class="line">    sign_in_count: <span class="type">u64</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">build_user</span>(email: <span class="type">String</span>, username: <span class="type">String</span>) <span class="punctuation">-&gt;</span> User &#123;</span><br><span class="line">    User &#123;</span><br><span class="line">        email,			<span class="comment">//çœç•¥å­—æ®µå</span></span><br><span class="line">        username,</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>å¯ä»¥ä½¿ç”¨ç°å­˜objectç”Ÿæˆæ–°çš„objectï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¦‚æœéƒ¨åˆ†å­—æ®µå‘ç”Ÿmoveä¼šå¯¼è‡´åŸobjectè¢«moveçš„å­—æ®µå¤±æ•ˆ</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    active: <span class="type">bool</span>,</span><br><span class="line">    username: <span class="type">String</span>,</span><br><span class="line">    email: <span class="type">String</span>,</span><br><span class="line">    sign_in_count: <span class="type">u64</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">user1</span> = User &#123;</span><br><span class="line">        email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someone@example.com&quot;</span>),</span><br><span class="line">        username: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;someusername123&quot;</span>),</span><br><span class="line">        active: <span class="literal">true</span>,</span><br><span class="line">        sign_in_count: <span class="number">1</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">user2</span> = User &#123;</span><br><span class="line">        email: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;another@example.com&quot;</span>),</span><br><span class="line">        ..user1</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°ä¾‹å­ä¸­user2åˆ›å»ºåï¼Œ<code>user1.username</code>æ— æ³•ä½¿ç”¨ï¼Œä½†<code>user1.email</code>è¿˜å¯ä»¥ä½¿ç”¨</p>
<h3 id="Tuple-Structs-amp-Unit-Like-Structs"><a href="#Tuple-Structs-amp-Unit-Like-Structs" class="headerlink" title="Tuple Structs &amp; Unit-Like Structs"></a>Tuple Structs &amp; Unit-Like Structs</h3><p>ä½¿ç”¨åœ†æ‹¬å·ä»£æ›¿å¤§æ‹¬å·å¯ä»¥åˆ›å»ºTuple Structsï¼Œå…¶ç‰¹æ€§ä¸Tupleç±»ä¼¼ï¼Œä½†æ˜¯å…¶æœ¬èº«æ‹¥æœ‰ä¸€ä¸ªç‰¹å®šçš„ç±»å‹åï¼Œä¸åŒç±»å‹çš„Tuple Structå“ªæ€•æˆå‘˜ç»“æ„å®Œå…¨ç›¸åŒéƒ½ä¸èƒ½æ··ç”¨</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Color</span>(<span class="type">i32</span>, <span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span>(<span class="type">i32</span>, <span class="type">i32</span>, <span class="type">i32</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">black</span> = <span class="title function_ invoke__">Color</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">origin</span> = <span class="title function_ invoke__">Point</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>Unit-Likeæ˜¯ä¸åŒ…å«ä»»ä½•æˆå‘˜çš„ç»“æ„ä½“ï¼Œç”¨äºå®ç°æŸäº›traitï¼Œä½†æ˜¯æœ¬èº«åˆä¸ç”¨å­˜å‚¨æ•°æ®çš„ç»“æ„ä½“</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">AlwaysEqual</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">subject</span> = AlwaysEqual;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="é€šè¿‡å®ä¸ºStructå®ç°ç‰¹å®šçš„trait"><a href="#é€šè¿‡å®ä¸ºStructå®ç°ç‰¹å®šçš„trait" class="headerlink" title="é€šè¿‡å®ä¸ºStructå®ç°ç‰¹å®šçš„trait"></a>é€šè¿‡å®ä¸ºStructå®ç°ç‰¹å®šçš„trait</h3><p>println!å®å¯ä»¥é€šè¿‡<code>&#123;:?&#125;</code>æˆ–<code>&#123;:#?&#125;</code>å ä½ç¬¦æ‰“å°å®ç°äº†Debugçš„struct</p>
<p>éƒ¨åˆ†traitç”±äºåŠŸèƒ½å…·æœ‰ä¸€å®šçš„æ™®é€‚æ€§ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å®è‡ªåŠ¨ç”Ÿæˆ(ä¸ªäººç†è§£æ˜¯Rustæä¾›äº†ä¸€å¥—æ¨¡æ¿ï¼Œå¯ä»¥ä½¿ç”¨å®ç›´æ¥å¥—è¿™ä¸ªæ¨¡æ¿ç”Ÿæˆç‰¹å®šçš„Trait)</p>
<p>è¯­æ³•å¦‚ä¸‹</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">rect1</span> = Rectangle &#123;</span><br><span class="line">        width: <span class="number">30</span>,</span><br><span class="line">        height: <span class="number">50</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:#?&#125;&quot;</span>, rect1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="implå—"><a href="#implå—" class="headerlink" title="implå—"></a>implå—</h3><p>implå—ä¸­å¯ä»¥å®šä¹‰æˆå‘˜æ–¹æ³•ä¸éæˆå‘˜æ–¹æ³•ï¼Œéæˆå‘˜æ–¹æ³•ä¹Ÿä¼šè·ŸimplæŒ‡å®šçš„ç±»å…³è”ï¼Œç±»ä¼¼äºcppä¸­ç±»çš„é™æ€æ–¹æ³•</p>
<h4 id="å®šä¹‰æˆå‘˜æ–¹æ³•"><a href="#å®šä¹‰æˆå‘˜æ–¹æ³•" class="headerlink" title="å®šä¹‰æˆå‘˜æ–¹æ³•"></a>å®šä¹‰æˆå‘˜æ–¹æ³•</h4><p>ä½¿ç”¨implå—å¯ä»¥è¿›å…¥ç»™å®šç±»çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä¸ºå…¶å®šä¹‰æˆå‘˜æ–¹æ³•</p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»åå­—ä¸º<code>self</code>ä¸”ç±»å‹ä¸º<code>Self</code>(æˆ–<code>&amp;Self</code>)</p>
<p>åŒæ—¶æˆå‘˜æ–¹æ³•å¯ä»¥å€Ÿç”¨selfï¼Œä¹Ÿå¯ä»¥å¤ºå–owner(å¤ºå–åè°ƒç”¨æ–¹æ³•çš„å¯¹è±¡æ— æ³•ç»§ç»­ä½¿ç”¨)</p>
<h4 id="å®šä¹‰éæˆå‘˜æ–¹æ³•"><a href="#å®šä¹‰éæˆå‘˜æ–¹æ³•" class="headerlink" title="å®šä¹‰éæˆå‘˜æ–¹æ³•"></a>å®šä¹‰éæˆå‘˜æ–¹æ³•</h4><p>éæˆå‘˜æ–¹æ³•å³ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯selfçš„æ–¹æ³•ï¼Œéœ€è¦é€šè¿‡<code>ç±»å::æ–¹æ³•å</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡ŒSelfå³ä»£æŒ‡implåç»™å®šçš„ç±»</span></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">square</span>(size: <span class="type">u32</span>) <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123; </span><br><span class="line">        <span class="keyword">Self</span> &#123;</span><br><span class="line">            width: size,</span><br><span class="line">            height: size,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">sq</span> = Rectangle::<span class="title function_ invoke__">square</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="6-Enums-and-Pattern-Matching"><a href="#6-Enums-and-Pattern-Matching" class="headerlink" title="6. Enums and Pattern Matching"></a>6. Enums and Pattern Matching</h2><p>rustä¸­çš„æšä¸¾å¯ä»¥æºå¸¦æ•°æ®ï¼Œå¹¶ä¸”ç»Ÿä¸€æšä¸¾ä¸­ä¸åŒæšä¸¾å€¼å¯ä»¥æºå¸¦çš„æ•°æ®ç±»å‹ä¸ä¸€æ ·</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">IpAddr</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">V4</span>(<span class="type">String</span>),</span><br><span class="line">        <span class="title function_ invoke__">V6</span>(<span class="type">String</span>),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">home</span> = IpAddr::<span class="title function_ invoke__">V4</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;127.0.0.1&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">loopback</span> = IpAddr::<span class="title function_ invoke__">V6</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;::1&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶å¯ä»¥ä¸ºæšä¸¾å®ç°æˆå‘˜å‡½æ•°</p>
<h3 id="Option-Enum"><a href="#Option-Enum" class="headerlink" title="Option Enum"></a>Option Enum</h3><p>Rustä¸­æœ‰ä¸€ç±»ç‰¹åˆ«çš„æšä¸¾<code>Option&lt;T&gt;</code></p>
<p>å…¶æœ‰ä¸¤ç§å¯èƒ½çš„å€¼<code>None</code>å’Œ<code>Some(T)</code></p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Option</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">    <span class="title function_ invoke__">Some</span>(T),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æŸäº›å¯èƒ½è¿”å›ç¼ºçœå€¼çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è¿”å›<code>Option&lt;T&gt;</code>ç±»å‹</p>
<p>å¦‚æœè¿”å›Some(T)åˆ™æ˜¯æœ‰æ•ˆå€¼ï¼Œè¿”å›Noneåˆ™ä¸ºç¼ºçœå€¼</p>
<p>Rustæ•…æ„ä½¿Some(T)ä¸Tæ— æ³•æ··ç”¨ä»¥ä¾¿è®©å¼€å‘äººå‘˜æ³¨æ„å¤„ç†è¿”å›Noneçš„æƒ…å†µ</p>
<h3 id="Match-with-Enum"><a href="#Match-with-Enum" class="headerlink" title="Match with Enum"></a>Match with Enum</h3><p>matchå¯ä»¥åŒ¹é…æšä¸¾çš„å€¼è¿›è¡Œä¸åŒçš„æ“ä½œï¼ŒåŒæ—¶è¿˜å¯ä»¥å–å‡ºå…¶ä¸­å¯èƒ½æºå¸¦çš„æ•°æ®è¿›è¡Œç›¸åº”æ“ä½œ</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">UsState</span> &#123;</span><br><span class="line">    Alabama,</span><br><span class="line">    Alaska,</span><br><span class="line">    <span class="comment">// --snip--</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Coin</span> &#123;</span><br><span class="line">    Penny,</span><br><span class="line">    Nickel,</span><br><span class="line">    Dime,</span><br><span class="line">    <span class="title function_ invoke__">Quarter</span>(UsState),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">value_in_cents</span>(coin: Coin) <span class="punctuation">-&gt;</span> <span class="type">u8</span> &#123;</span><br><span class="line">    <span class="keyword">match</span> coin &#123;</span><br><span class="line">        Coin::Penny =&gt; <span class="number">1</span>,</span><br><span class="line">        Coin::Nickel =&gt; <span class="number">5</span>,</span><br><span class="line">        Coin::Dime =&gt; <span class="number">10</span>,</span><br><span class="line">        Coin::<span class="title function_ invoke__">Quarter</span>(state) =&gt; &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;State quarter from &#123;:?&#125;!&quot;</span>, state);</span><br><span class="line">            <span class="number">25</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">value_in_cents</span>(Coin::<span class="title function_ invoke__">Quarter</span>(UsState::Alaska));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶matchä¹Ÿå¯ä»¥ç”¨äºå¤„ç†Optionæšä¸¾</p>
<p>matchçš„<code>_ =&gt; ()</code>armå¯ä»¥åœ¨å…¶ä½™æƒ…å†µä¸‹ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</p>
<h3 id="if-let"><a href="#if-let" class="headerlink" title="if let"></a>if let</h3><p>if letå¯ä»¥é’ˆå¯¹å½“enumä¸ºæŸä¸€ç‰¹å®šæƒ…å†µæ—¶å±•å¼€å·¥ä½œï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹æ‰§è¡Œelse(å¦‚æœå­˜åœ¨)çš„æ“ä½œï¼Œç±»ä¼¼äºä¸€ä¸ªç®€åŒ–ç‰ˆçš„matchï¼Œä¸ä¼šæ˜¾å¼è¦æ±‚å¤„ç†æ‰€æœ‰æƒ…å†µ</p>
<p>if let</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">coin</span> = Coin::Penny;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Coin</span>::<span class="title function_ invoke__">Quarter</span>(state) = coin &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;State quarter from &#123;:?&#125;!&quot;</span>, state);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        count += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>match</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">coin</span> = Coin::Penny;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">count</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">match</span> coin &#123;</span><br><span class="line">        Coin::<span class="title function_ invoke__">Quarter</span>(state) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;State quarter from &#123;:?&#125;!&quot;</span>, state),</span><br><span class="line">        _ =&gt; count += <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>äºŒè€…ç­‰ä»· </p>
<h2 id="7-Managing-Growing-Projects-with-Packages-Crates-and-Modules"><a href="#7-Managing-Growing-Projects-with-Packages-Crates-and-Modules" class="headerlink" title="7. Managing Growing Projects with Packages, Crates, and Modules"></a>7. Managing Growing Projects with Packages, Crates, and Modules</h2><h3 id="Packages-amp-Crates"><a href="#Packages-amp-Crates" class="headerlink" title="Packages &amp; Crates"></a>Packages &amp; Crates</h3><p>crateæ˜¯Rustç¼–è¯‘å™¨å¤„ç†ä»£ç æ—¶çš„æœ€å°å•ä½ï¼Œcrateåˆ†ä¸ºbinary crateå’Œlibrary crate</p>
<p>binary crateå¯ä»¥ç¼–è¯‘ä¸ºå¯è¿è¡Œç¨‹åºï¼Œlibrary crateå¯ä»¥ç¼–è¯‘æˆåº“</p>
<p>packageæ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªæä¾›ä¸€ç³»åˆ—åŠŸèƒ½çš„ç»„åˆï¼Œä¸€ä¸ªpackageå¯ä»¥åŒ…å«ä»»æ„ä¸ªbin crateï¼Œä½†åªèƒ½åŒ…å«ä¸€ä¸ªlib crate</p>
<p>src/main.rs æ˜¯crate root</p>
<p>src/lib.rs    ä¹Ÿæ˜¯crate root</p>
<p>src/bin/é‡Œé¢çš„æ–‡ä»¶éƒ½ä¼šè¢«å½“ä½œç‹¬ç«‹çš„binary crate</p>
<p>[rust api guidelines](<a target="_blank" rel="noopener" href="https://rust-lang.github.io/api-guidelines/">About - Rust API Guidelines (rust-lang.github.io)</a>)</p>
<h3 id="Modules"><a href="#Modules" class="headerlink" title="Modules"></a>Modules</h3><p>crate rootå¯ä»¥åˆ›å»ºæ–°çš„æ¨¡å—ï¼Œåœ¨éæ ¹æ¨¡å—ä¸­ä¹Ÿå¯ä»¥åˆ›å»ºå­æ¨¡å—</p>
<p><img src="/2022/12/05/RustNote/.././note.assets/image-20221202160141439.png" alt="image-20221202160141439"></p>
<p>çˆ¶æ¨¡å—ä¸èƒ½ç›´æ¥è®¿é—®å­æ¨¡å—ä¸­çš„å†…å®¹ï¼Œé™¤éå­æ¨¡å—å…¬å¼€(pub)</p>
<p>åŒå±ä¸€ä¸ªçˆ¶æ¨¡å—ä¸‹çš„å…„å¼Ÿæ¨¡å—å¯ä»¥ç›¸äº’è®¿é—®</p>
<p>æ ¹æ¨¡å—åœ¨è·¯å¾„ä¸­åç§°ä¸º<code>crate</code></p>
<p>æ¨¡å—è·¯å¾„å¯»å€æ”¯æŒç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ï¼ŒåŒæ—¶å¯ä»¥ç”¨<code>super</code>æŒ‡ä»£çˆ¶æ¨¡å—</p>
<p><code>Best Practices for Packages with a Binary and a Library</code></p>
<p>åœ¨lib.rsä¸­å®ç°ä¸€å¥—apiï¼ŒåŒæ—¶main.rsä½œä¸ºapiçš„ä½¿ç”¨è€…å®ç°åŠŸèƒ½</p>
<p>Structså…¬å¼€æ—¶å…¶å†…éƒ¨æˆå‘˜ä¾æ—§æ˜¯privateï¼Œéœ€è¦å•ç‹¬æŒ‡å®špubæˆå‘˜ï¼›enumå…¬å¼€æ—¶å…¶æ‰€æœ‰å˜ä½“ä¹Ÿéƒ½æ˜¯å…¬å¼€çš„</p>
<p>é€šå¸¸ä½¿ç”¨useå¸Œæœ›å°†æŸä¸ªå‡½æ•°å¼•å…¥scopeæ—¶ï¼Œä¸ç›´æ¥å°†å…¶å¼•å…¥ï¼Œè€Œæ˜¯å¼•å…¥å…¶çˆ¶æ¨¡å—ï¼Œè¿™æ ·èƒ½å¤Ÿæ›´å¥½çš„åŒºåˆ†ä»å¤–å¼•å…¥çš„å¯¹è±¡ä¸æœ¬åœ°å¯¹è±¡ï¼›è€Œå¼•å…¥ç»“æ„ä½“ã€æšä¸¾æ—¶åˆ™é€šå¸¸ç›´æ¥å¼•å…¥ï¼Œè¿™æ˜¯ä¸€ç§ä¹ æƒ¯</p>
<h2 id="8-Common-Collections"><a href="#8-Common-Collections" class="headerlink" title="8. Common Collections"></a>8. Common Collections</h2><h3 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h3><p>åˆ›å»ºç©ºVector</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">v</span>: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨å·²æœ‰å€¼åˆ›å»ºVector</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">v</span> = <span class="built_in">vec!</span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure>



<p>å¯ä»¥é€šè¿‡enumè®©vectorå­˜å‚¨ä¸åŒç±»å‹çš„å€¼</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">SpreadsheetCell</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Int</span>(<span class="type">i32</span>),</span><br><span class="line">    <span class="title function_ invoke__">Float</span>(<span class="type">f64</span>),</span><br><span class="line">    <span class="title function_ invoke__">Text</span>(<span class="type">String</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="variable">row</span> = <span class="built_in">vec!</span>[</span><br><span class="line">    SpreadsheetCell::<span class="title function_ invoke__">Int</span>(<span class="number">3</span>),</span><br><span class="line">    SpreadsheetCell::<span class="title function_ invoke__">Text</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;blue&quot;</span>)),</span><br><span class="line">    SpreadsheetCell::<span class="title function_ invoke__">Float</span>(<span class="number">10.12</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure>



<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>Stringçš„å®ç°å®é™…ä¸Šå°±æ˜¯<code>Vec&lt;u8&gt;</code>ï¼Œä»¥utf8çš„å½¢å¼å­˜å‚¨å­—ç¬¦ä¸²</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºStringçš„å‡ ç§æ–¹æ³•</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="string">&quot;Hello&quot;</span>.<span class="title function_ invoke__">to_string</span>();</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨push/push_strçš„æ–¹å¼æ‹¼æ¥å­—ç¬¦/å­—ç¬¦ä¸²</p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨+è¿ç®—ç¬¦ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ‰€æœ‰æƒä¼šè¢«moveç»™addå‡½æ•°ï¼Œå¹¶åœ¨éšåè¿”å›æ‹¼æ¥å¥½çš„å­—ç¬¦ä¸²ï¼Œå…¶ä½™å‚æ•°å¯ä»¥ä½¿ç”¨å¼•ç”¨</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello, &quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;world!&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s3</span> = s1 + &amp;s2; <span class="comment">// note s1 has been moved here and can no longer be used</span></span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°è¿ç®—çš„æœ¬è´¨å…¶å®æ˜¯addå‡½æ•°takeäº†s1çš„onwerï¼Œå¹¶ä¸”å°†s2çš„å†…å®¹pushåˆ°s1çš„åé¢ï¼Œå¹¶å°†å…¶è¿”å›ï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰å‘ç”Ÿå¤§é‡çš„æ‹·è´å·¥ä½œ</p>
<p>åœ¨æŸäº›æƒ…å†µä¸‹ä½¿ç”¨formatå®æ›´æ–¹ä¾¿</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">s1</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;tic&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s2</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;tac&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s3</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;toe&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>, s1, s2, s3);</span><br></pre></td></tr></table></figure>



<p>ç”±äºä»¥utf8æ ¼å¼ç¼–ç å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥Stringä¸èƒ½ç›´æ¥ç´¢å¼•</p>
<p>as_byteså¯ä»¥è·å–å­—èŠ‚æ•°ç»„</p>
<p>charså¯ä»¥è·å–å­—ç¬¦æ•°ç»„</p>
<h3 id="Hash-Map"><a href="#Hash-Map" class="headerlink" title="Hash Map"></a>Hash Map</h3><p>åˆ›å»ºç©ºhashmap</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">scores</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">    scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Blue&quot;</span>), <span class="number">10</span>);</span><br><span class="line">    scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Yellow&quot;</span>), <span class="number">50</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ²¡æœ‰ä¸‹é¢é‚£äº›insertè¯­å¥ï¼Œéœ€è¦æŒ‡æ˜mapçš„å…·ä½“ç±»å‹</p>
<p>ä¸‹é¢é‚£äº›insertè¯­å¥ä¼šå¸®åŠ©ç¼–è¯‘å™¨æ¨æ–­ç±»å‹ä¸º<code>HashMap&lt;String, i32&gt;</code></p>
<p>ä½¿ç”¨getæ–¹æ³•è®¿é—®hash mapä¼šè®¿é—®Option&lt;&amp;T&gt;</p>
<p>ä½¿ç”¨entryæ–¹æ³•å¯ä»¥è·å–æŸä¸€keyçš„å¯¹åº”valueï¼Œå¦‚æœkeyä¸å­˜åœ¨åˆ™å¡«å…¥æ–°valueï¼Œæœ€ç»ˆè¿”å›è¯¥valueçš„mutå¼•ç”¨</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">text</span> = <span class="string">&quot;hello world wonderful world&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">map</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> <span class="variable">word</span> <span class="keyword">in</span> text.<span class="title function_ invoke__">split_whitespace</span>() &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">count</span> = map.<span class="title function_ invoke__">entry</span>(word).<span class="title function_ invoke__">or_insert</span>(<span class="number">0</span>);</span><br><span class="line">        *count += <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, map);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2022/07/12/WindowsInternal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/07/12/WindowsInternal/" class="post-title-link" itemprop="url">Windows Internal éšè®°</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-07-12 12:45:45" itemprop="dateCreated datePublished" datetime="2022-07-12T12:45:45+00:00">2022-07-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-09-05 14:40:48" itemprop="dateModified" datetime="2022-09-05T14:40:48+00:00">2022-09-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Windows-Internal"><a href="#Windows-Internal" class="headerlink" title="Windows Internal"></a>Windows Internal</h1><h2 id="CHAPTER-2-System-architecture"><a href="#CHAPTER-2-System-architecture" class="headerlink" title="CHAPTER 2 System architecture"></a>CHAPTER 2 System architecture</h2><p><img src="/2022/07/12/WindowsInternal/../WindowsInternal/uTools_0igR8j8Mnj.png" alt="uTools_0igR8j8Mnj"></p>
<h3 id="Hypervisor"><a href="#Hypervisor" class="headerlink" title="Hypervisor"></a>Hypervisor</h3><p>VTL 0ä¸VTL 1æ˜¯ä¸€ç§ç±»ä¼¼éš”ç¦»çš„æœºåˆ¶ï¼Œä¸åŸæœ‰çš„Ringæœºåˆ¶æœ‰ä¸€å®šçš„ç‹¬ç«‹æ€§ï¼ŒVTL 0çš„å†…æ ¸æ— æ³•è®¿é—®VTL 1çš„ç”¨æˆ·æ€å†…å­˜ï¼Œè™šæ‹Ÿæœºç›‘è§†å™¨æ˜¯æ“ä½œç³»ç»Ÿç¬¬ä¸€ä¸ªåˆå§‹åŒ–çš„ç»„ä»¶ï¼Œä»–ä¼šè®¾ç½®I/O MMUï¼ˆé¿å…é€šè¿‡DMAç›´æ¥è®¿é—®ç‰©ç†å†…å­˜ï¼‰ä»¥åŠSLATï¼Œç”¨æ¥æ§åˆ¶VTL 0ä¸­çš„å†…å­˜è®¿é—®ã€‚</p>
<p>VTL 1çš„secure kernelä½¿ç”¨ç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶securekernel.exeï¼ŒåŒæ—¶IUMçš„dllä¹Ÿæœ‰æ‰€ä¸åŒï¼Œlumdll.dllå¯¹åº”ntdll.dllï¼Œlumbase.dllå¯¹åº”Kernelbase.dll</p>
<h3 id="User-Mode"><a href="#User-Mode" class="headerlink" title="User Mode"></a>User Mode</h3><h4 id="subsystem"><a href="#subsystem" class="headerlink" title="subsystem"></a>subsystem</h4><p>å­ç³»ç»Ÿæœ‰ä»¥ä¸‹ä¸»è¦æ„ä»¶</p>
<ul>
<li>ä¸€ä¸ªç¯å¢ƒå­ç³»ç»Ÿè¿›ç¨‹å®ä¾‹Csrss.exeä»¥åŠå…¶åŠ è½½çš„å››ä¸ªDLLï¼ŒBasesrv.dllï¼ŒWinsrv.dllï¼ŒSxssrv.dllï¼ŒCsrsrv.dll</li>
<li>ä½äºå†…æ ¸æ€çš„Win32k.sys</li>
<li>ä¸ºæ§åˆ¶å°æä¾›æ”¯æŒçš„Conhost.exe</li>
<li>å°†å¤šä¸ªå¯è§†çª—å£åˆæˆæ¸²æŸ“åˆ°ä¸€ä¸ªå›¾å½¢ç•Œé¢ä¸Šçš„dwm.exe</li>
<li>å­ç³»ç»ŸDLL</li>
<li>ç¡¬ä»¶çš„å›¾å½¢åŒ–è®¾å¤‡é©±åŠ¨</li>
</ul>
<p>ç°ç‰ˆæœ¬Windowsä»…æœ‰ä¸€ä¸ªsubsystemï¼Œåç§°ä¹ŸåŒä¸ºwindowsï¼Œæ¯ä¸€ä¸ªSessionéƒ½æœ‰ä¸€ä¸ªè¿›ç¨‹åä¸ºCsrss.exeï¼Œè¯¥è¿›ç¨‹ä¸ºç¯å¢ƒå­ç³»ç»Ÿè¿è¡Œå®ä¾‹ï¼Œå­ç³»ç»Ÿä¹‹ä¸Šçš„åº”ç”¨ç¨‹åºè°ƒç”¨ç‰¹å®šAPIæ—¶ä¼šå‡ºç°ä»¥ä¸‹ä¸‰ç§æƒ…å†µ</p>
<ul>
<li>è¯¥APIå®ç°åŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œç›´æ¥åœ¨ç‰¹å®šdllå†…éƒ¨å³å¯å®Œæˆ</li>
<li>éœ€è¦åˆ‡æ¢åˆ°å†…æ ¸æ€å®ç°åŠŸèƒ½ï¼Œæ­¤æ—¶APIä»£ç ä¼šè°ƒç”¨ntdll.dllå†…çš„æ¡©ä»£ç è¿›å…¥å†…æ ¸æ€</li>
<li>éœ€è¦åœ¨å­ç³»ç»Ÿè¿›ç¨‹(Csrss.exeï¼ŒClient/Server Runtime SubSystem)å®Œæˆï¼Œæ­¤æ—¶subsystem dllé€šè¿‡ALPCå‘å­ç³»ç»Ÿè¿›ç¨‹å‘å‡ºè¯·æ±‚ï¼ŒåŒæ—¶ç­‰å¾…å…¶å›åº”</li>
</ul>
<p>åœ¨Win8ä¹‹åï¼Œcmd.exeä¼šåˆ›å»ºconhost.exeçº¿ç¨‹ï¼Œåè€…ç”¨äºä¸ConDrv.sysé€šä¿¡ï¼Œè¯¥é©±åŠ¨ç”¨æ¥å¤„ç†I/Oè¾“å…¥ï¼Œç”¨æ¥å‡è½»Csrss.exeä¸Šä¸‹æ–‡åˆ‡æ¢çš„å‹åŠ›</p>
<h4 id="WSL"><a href="#WSL" class="headerlink" title="WSL"></a>WSL</h4><p>WSL(Windows Subsystem for Linux)ä¸ä¸Šè¿°environment subsystemä¸éš¶å±åŒä¸€èŒƒç•´ï¼ŒWSLä½¿ç”¨Pico Provideræœºåˆ¶ï¼Œä½¿ç”¨LXCoreä¸LXSSä¸¤ä¸ªé©±åŠ¨ï¼Œå‘å†…æ ¸æ³¨å†Œè‡ªèº«ï¼Œåœ¨æ­¤ä¹‹åä¾¿å¯ç”±è¿™ä¸¤ä¸ªé©±åŠ¨å¤„ç†ç”¨æˆ·æ€Pico Processçš„å„é¡¹ç³»ç»Ÿè°ƒç”¨</p>
<p>ä¸ºäº†æ›´å¥½åœ°å®ç°Linuxçš„ç‰¹æ€§ï¼Œé€‚é…Linuxç¨‹åºï¼ŒWindowsä¸Linuxä¹‹é—´æœ‰ä¸€éƒ¨åˆ†ç±»ä¼¼ä½†å…·æœ‰ä¸€å®šå·®å¼‚çš„ç‰¹æ€§ï¼ˆä¾‹å¦‚å…·åç®¡é“ï¼‰ä¸èƒ½é‡å¤åˆ©ç”¨ï¼Œåªèƒ½é‡æ–°å®ç°ã€‚</p>
<h4 id="ntdll-dll"><a href="#ntdll-dll" class="headerlink" title="ntdll.dll"></a>ntdll.dll</h4><p>åŒ…å«ä¸¤ç±»ä»£ç </p>
<ul>
<li>ç³»ç»Ÿè°ƒç”¨æ¡©ä»£ç </li>
<li>è¢«subsystemã€subsystem dlä»¥åŠå…¶å®ƒnativeé•œåƒä½¿ç”¨çš„å†…éƒ¨å‡½æ•°<ul>
<li>ä»¥Ldrå¼€å¤´çš„image loader</li>
<li>å †ç®¡ç†å™¨</li>
<li>ä»¥Csrå¼€å¤´çš„å­ç³»ç»Ÿè¿›ç¨‹é€šä¿¡å‡½æ•°</li>
<li>ä»¥Rtlå¼€å¤´çš„è¿è¡Œæ—¶åº“ä¾‹ç¨‹</li>
<li>ä»¥DbgUiå¼€å¤´çš„ç”¨æˆ·æ€è°ƒè¯•æ”¯æŒå‡½æ•°</li>
<li>ä»¥Etwå¼€å¤´çš„Windowsäº‹ä»¶è¿½è¸ª(Event Tracing for Windows)å‡½æ•°</li>
<li>ç”¨æˆ·æ€å¼‚æ­¥è¿‡ç¨‹è°ƒç”¨è°ƒåº¦å™¨ä»¥åŠå¼‚å¸¸è°ƒåº¦å™¨</li>
</ul>
</li>
</ul>
<p>æ¡©ä»£ç ä¼šæ£€æŸ¥ SharedUserData + 0x308 å­—æ®µå†³å®šä½¿ç”¨syscallè¿˜æ˜¯int 2Ehè¿›å…¥ç³»ç»Ÿè°ƒç”¨ï¼Œå½“å¯ç”¨äº†Credential Guard VBSå±æ€§æ—¶ï¼Œä¼šä½¿ç”¨int 2Ehï¼Œå› ä¸ºç›¸è¾ƒäºsyscallï¼Œhypervisorå¯¹intæŒ‡ä»¤å¤„ç†æ›´æœ‰æ•ˆç‡</p>
<h4 id="Native-images"><a href="#Native-images" class="headerlink" title="Native images"></a>Native images</h4><p>éƒ¨åˆ†è¿›ç¨‹è¿è¡Œä¼šæ—©äºå­ç³»ç»Ÿåˆå§‹åŒ–ï¼Œè¿™äº›è¿›ç¨‹ä»…ä¾èµ–ntdll.dllï¼Œä¾‹å¦‚Smss.exe(Session Manager process)ï¼ŒSmssæ˜¯ç¬¬ä¸€ä¸ªç”¨æˆ·æ€è¿›ç¨‹ï¼Œç”±å†…æ ¸ç›´æ¥åˆ›å»ºï¼ŒåŒæ—¶ç”±ä»–æ¥è´Ÿè´£å¯åŠ¨Csrss.exe</p>
<h3 id="Kernel-Mode"><a href="#Kernel-Mode" class="headerlink" title="Kernel Mode"></a>Kernel Mode</h3><h4 id="Executive"><a href="#Executive" class="headerlink" title="Executive"></a>Executive</h4><p>æ˜¯Ntoskrnl.exeçš„ä¸Šå±‚éƒ¨åˆ†ï¼Œå…¶ä¸­åŒ…å«äº†ä¸‹åˆ—ç§ç±»çš„å‡½æ•°</p>
<ul>
<li><strong>å¯¹å¤–å¯¼å‡ºä¸”å¯åœ¨ç”¨æˆ·æ€è°ƒç”¨çš„å‡½æ•°</strong> è¿™äº›å‡½æ•°è¢«ç§°ä¸º<em>system service</em>å¹¶ä¸”é€šè¿‡Ntdll.dllå¯¼å‡ºï¼Œä¾‹å¦‚NtCreateFileã€‚è¿™äº›å‡½æ•°ç»å¤§å¤šæ•°éƒ½å¯ä»¥é€šè¿‡Windows APIæˆ–è€…å­ç³»ç»ŸAPIè®¿é—®ï¼Œä¹Ÿæœ‰ä¸€å°‘éƒ¨åˆ†æ— æ³•é€šè¿‡è®°å½•çš„APIè°ƒç”¨ã€‚</li>
<li><strong>é€šè¿‡DeviceIoControlè°ƒç”¨çš„è®¾å¤‡é©±åŠ¨å‡½æ•°</strong> å®ƒä»¬æä¾›äº†ä¸€ä¸ªç”¨æˆ·æ¨¡å¼åˆ°å†…æ ¸æ¨¡å¼çš„é€šç”¨æ¥å£ï¼Œç”¨äºè°ƒç”¨è®¾å¤‡é©±åŠ¨ä¸­ä¸è¯»å†™æ— å…³çš„å‡½æ•°(?)</li>
<li><strong>è®°å½•åœ¨WDKä¸­åªèƒ½åœ¨å†…æ ¸æ€è°ƒç”¨çš„å¯¼å‡ºå‡½æ•°</strong><ul>
<li>ä»¥Ioå¼€å¤´çš„I/Oç®¡ç†å™¨ä¾‹ç¨‹</li>
<li>ä»¥Exå¼€å¤´çš„é€šç”¨executiveå‡½æ•°</li>
</ul>
</li>
<li><strong>å·²è¢«å¯¼å‡ºä½†æœªè®°å½•åœ¨WDKä¸­èƒ½åœ¨å†…æ ¸æ€è°ƒç”¨çš„å‡½æ•°</strong> åŒ…å«äº†ç”±boot video driverè°ƒç”¨çš„å‡½æ•°ï¼Œä»¥Inbvå¼€å¤´</li>
<li><strong>å¹¶æœªå¯¼å‡ºä½†æ˜¯è¢«å®šä¹‰ä¸ºå…¨å±€ç¬¦å·çš„å‡½æ•°</strong> è¿™äº›å‡½æ•°åŒ…å«å†…éƒ¨æ”¯æŒå‡½æ•°ï¼Œä¾‹å¦‚ä»¥Iopå¼€å¤´çš„å†…éƒ¨I/Oç®¡ç†æ”¯æŒå‡½æ•°ä»¥åŠä»¥Miå¼€å¤´çš„å†…éƒ¨å†…å­˜ç®¡ç†æ”¯æŒå‡½æ•°</li>
<li><strong>åœ¨æ¨¡å—å†…æœªè¢«å®šä¹‰ä¸ºå…¨å±€ç¬¦å·çš„å‡½æ•°</strong> è¿™äº›å‡½æ•°åªèƒ½ç”±executiveå’Œkernelä½¿ç”¨(å³åªèƒ½åœ¨ntoskrnlå†…ä½¿ç”¨)</li>
</ul>
<p>è¯¥å±‚å†…æœ‰ä»¥ä¸‹ä¸»è¦ç»„ä»¶</p>
<ul>
<li><strong>Configuration manager</strong> é…ç½®ç®¡ç†å™¨ï¼Œè´Ÿè´£å®ç°ä¸ç®¡ç†æ³¨å†Œè¡¨</li>
<li><strong>Process manager</strong> è¿›ç¨‹ç®¡ç†å™¨ï¼Œè´Ÿè´£åˆ›å»ºä¸ç»ˆæ­¢è¿›ç¨‹å’Œçº¿ç¨‹ï¼Œè¿›ç¨‹å’Œè¿›ç¨‹çš„åº•å±‚å®ç°ç”±ä¸‹å±‚çš„å†…æ ¸æä¾›ï¼Œè¯¥éƒ¨ä»¶ä¸ºè¿™äº›åº•å±‚å¯¹è±¡æä¾›æ›´å¤šçš„è¯­ä¹‰åŠå‡½æ•°(ä¸ªäººç†è§£å³è¿›è¡Œäº†åŒ…è£…ï¼Œæä¾›äº†æ›´å¤šçš„æ“ä½œ)</li>
<li><strong>Security Reference Monitor</strong> SRMï¼Œå®‰å…¨å‚è€ƒç›‘è§†å™¨ï¼Œå¼ºåŒ–æœ¬æœºçš„å®‰å…¨æ”¿ç­–ï¼Œä¿æŠ¤ç³»ç»Ÿèµ„æºï¼Œæ‰§è¡Œè¿è¡Œæ—¶å¯¹è±¡å®¡æŸ¥ä¸ä¿æŠ¤</li>
<li><strong>I/O manager</strong> å®ç°ç‹¬ç«‹äºè®¾å¤‡ä¹‹ä¸Šçš„I/Oæ“ä½œï¼Œå¹¶ä¸”å°†I/Oå‘æ´¾ç»™åˆé€‚çš„è®¾å¤‡é©±åŠ¨åšè¿›ä¸€æ­¥å¤„ç†</li>
<li><strong>Plug and Play(PnP) manager</strong> PnPç®¡ç†å™¨ï¼Œåˆ¤æ–­æŸä¸€è®¾å¤‡éœ€è¦å“ªäº›é©±åŠ¨ï¼Œå¹¶ä¸”ä¸ºè¯¥è®¾å¤‡åŠ è½½è¿™äº›é©±åŠ¨ã€‚å®ƒä¼šåœ¨æšä¸¾æ—¶æŸ¥è¯¢æ¯ä¸€ä¸ªè®¾å¤‡çš„ç¡¬ä»¶èµ„æºéœ€æ±‚ï¼Œæ ¹æ®è¿™äº›éœ€æ±‚æ¥ä¸ºè®¾å¤‡åˆ†é…ç¡¬ä»¶èµ„æºï¼Œä¾‹å¦‚I/O ports, IRQs, DMAä»¥åŠmemory locationã€‚å®ƒåŒæ—¶ä¹Ÿè´Ÿè´£ä¸ºç³»ç»Ÿä¸Šçš„è®¾å¤‡æ›´æ”¹å‘é€åˆé€‚çš„äº‹ä»¶é€šçŸ¥ã€‚</li>
<li><strong>Power manager</strong> ç”µæºç®¡ç†å™¨ï¼Œprocessor power management(PPM)ä»¥åŠpower management  framework(PoFx)åè°ƒç”µæºäº‹ä»¶åŒæ—¶å‘è®¾å¤‡é©±åŠ¨ç”Ÿæˆç”µæºç®¡ç†I/Oé€šçŸ¥ã€‚</li>
<li><strong>Windows Driver Model (WDM) Windows Management Instrumentation (WMI) routines</strong> è¿™äº›ä¾‹ç¨‹å…è®¸è®¾å¤‡é©±åŠ¨å‘é€æ€§èƒ½å’Œé…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶å…è®¸ä»ç”¨æˆ·æ€WMIæœåŠ¡æ¥å—å‘½ä»¤</li>
<li><strong>Memory manager</strong> å†…å­˜ç®¡ç†å™¨å®ç°äº†è™šæ‹Ÿå†…å­˜ï¼ŒåŒæ—¶ä¸ºcache manageræä¾›åº•å±‚æ”¯æŒ</li>
<li><strong>Cache manager</strong> ç¼“å­˜ç®¡ç†å™¨é€šè¿‡å¤šç§æ‰‹æ®µæ”¹å–„åŸºäºæ–‡ä»¶çš„I/Oæ€§èƒ½ã€‚å°†æœ€è¿‘å¼•ç”¨çš„ç£ç›˜æ•°æ®æš‚å­˜åœ¨ä¸»å†…å­˜ä¸­ï¼Œå°†æ•°æ®çš„æ”¹åŠ¨å…ˆç•™å­˜åœ¨å†…å­˜ä¸­å¹¶ä¹‹ååœ¨åˆé€‚æ—¶å†™å…¥å†…å­˜</li>
</ul>
<p>å…¶ä¸­æœ‰å››å¤§ç±»æ”¯æŒå‡½æ•°</p>
<ul>
<li><strong>Object manager</strong> åˆ›å»ºã€ç®¡ç†ã€åˆ é™¤Windows executiveå¯¹è±¡</li>
<li><strong>Asynchronous LPC (ALPC) facility</strong> ALPCè®¾æ–½ç”¨äºåœ¨åŒä¸€å°è®¡ç®—æœºä¸Šçš„å®¢æˆ·è¿›ç¨‹å’ŒæœåŠ¡è¿›ç¨‹ä¹‹é—´ä¼ é€’ä¿¡æ¯</li>
<li><strong>Run-time library functions</strong> åŒ…æ‹¬å­—ç¬¦ä¸²å¤„ç†ã€ç®—æœ¯æ“ä½œã€æ•°æ®ç±»å‹è½¬åŒ–ä»¥åŠå®‰å…¨ç»“æ„å¤„ç†</li>
<li><strong>Executive support routines</strong> åŒ…æ‹¬äº†å†…å­˜åˆ†é…ã€äº’é”å†…å­˜è®¿é—®ä»¥åŠä¸€äº›ç‰¹åˆ«çš„åŒæ­¥æœºåˆ¶</li>
</ul>
<h4 id="Kernel"><a href="#Kernel" class="headerlink" title="Kernel"></a>Kernel</h4><p>ç”±ntoskrnlä¸­æä¾›åŸºç¡€æœºåˆ¶çš„ä¸€ç³»åˆ—å‡½æ•°ç»„æˆï¼Œå…¶ä¸­ä¹Ÿæœ‰ç›¸å½“ä¸€éƒ¨åˆ†å¯¹äºé©±åŠ¨å¼€å‘è€Œè¨€å¿…é¡»çš„å‡½æ•°è®°å½•åœ¨WDKä¸­ï¼Œè¿™äº›å‡½æ•°ä»¥<code>Ke</code>å¼€å¤´</p>
<h5 id="Kernel-Object"><a href="#Kernel-Object" class="headerlink" title="Kernel Object"></a>Kernel Object</h5><p>å†…æ ¸ä¸ºä¸Šå±‚çš„executiveæä¾›åº•å±‚æ”¯æŒï¼ŒåŒæ—¶å†…æ ¸åªå®ç°OSçš„åŸºæœ¬æœºåˆ¶ï¼Œé¿å…åˆ¶å®šæ‰§è¡Œç­–ç•¥ï¼ˆé™¤äº†çº¿ç¨‹è°ƒåº¦ï¼‰</p>
<p>executiveå±‚å°†è¯¸å¦‚çº¿ç¨‹ä¸€æ ·å¯å…±äº«èµ„æºè§†ä½œå¯¹è±¡ï¼Œä¸”æä¾›äº†å¤§é‡çš„æœºåˆ¶ä»¥ä¾¿åˆ©ç”¨å¯¹è±¡ï¼Œè€Œkernelå±‚ä¸­çš„å¯¹è±¡æ²¡æœ‰è¿™äº›æœºåˆ¶ï¼Œä»…ä»…ç”¨æ¥å¸®åŠ©å†…æ ¸æ§åˆ¶å¤„ç†å™¨ä»¥åŠä¸ºä¸Šå±‚æä¾›æ”¯æŒï¼Œå¤§å¤šæ•°executiveå¯¹è±¡ç”±ä¸€æˆ–å¤šä¸ªå†…æ ¸å¯¹è±¡å°è£…è€Œæ¥</p>
<ul>
<li><strong>control objects</strong> æ§åˆ¶å„ç§æ“ä½œç³»ç»ŸåŠŸèƒ½<ul>
<li>Asynchronous Procedure Call (APC)</li>
<li>Deferred Procedure Call (DPC)</li>
<li>ä¸€äº›I/Oç®¡ç†å™¨ä¼šç”¨åˆ°çš„å¯¹è±¡ï¼Œä¾‹å¦‚ä¸­æ–­å¯¹è±¡</li>
</ul>
</li>
<li><strong>dispatcher objects</strong> åŒ…å«å†…æ ¸çº¿ç¨‹ï¼Œäº’æ–¥é”ï¼Œäº‹ä»¶ï¼Œå†…æ ¸äº‹ä»¶å¯¹ï¼Œä¿¡å·é‡ï¼Œè®¡æ—¶å™¨å’Œå¯ç­‰å¾…è®¡æ—¶å™¨</li>
</ul>
<h5 id="Kernel-processor-control-region-and-control-block"><a href="#Kernel-processor-control-region-and-control-block" class="headerlink" title="Kernel processor control region and control block"></a>Kernel processor control region and control block</h5><p>å†…æ ¸åˆ©ç”¨<em>kernel processor control region</em>(KPCR)æ¥è®°å½•ä¸€äº›å¤„ç†å™¨ä¿¡æ¯ï¼Œä¾‹å¦‚IDT, task state segment(TSS), GDT</p>
<p>ä¸ºäº†ä¾¿äºå¤„ç†å™¨è®¿é—®KPCRæ•°æ®ï¼Œå¤„ç†å™¨å­˜å‚¨KPCRæŒ‡é’ˆåˆ°fså¯„å­˜å™¨(32ä½ç³»ç»Ÿ)æˆ–gså¯„å­˜å™¨(64ä½ç³»ç»Ÿ)ä¸­</p>
<p>KPCRæ˜¯å¯¹å¤–å…¬å¼€çš„ï¼Œå¯ä»¥è¢«å…¶ä»–é©±åŠ¨å’Œç³»ç»Ÿç»„ä»¶ä½¿ç”¨ï¼Œè€ŒKPCRå†…æœ‰ä¸€ä¸ªå†…åµŒç»“æ„<em>kernel processor control block</em>(KPRCB)ï¼Œè¯¥ç»“æ„åªè¢«ntoskrnl.exeä¸­çš„å†…æ ¸ä»£ç ä½¿ç”¨</p>
<p>ç»è¿‡å®éªŒï¼Œæ¯ä¸€ä¸ªé€»è¾‘æ ¸å¿ƒéƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„KPCRå’ŒKPRCB(6æ ¸12çº¿ç¨‹å®é™…ä¸Šæ˜¯12ä¸ªé€»è¾‘æ ¸å¿ƒï¼Œè¿™é‡Œç”¨åˆ°äº†è¶…çº¿ç¨‹æŠ€æœ¯)</p>
<h5 id="Hardware-support"><a href="#Hardware-support" class="headerlink" title="* Hardware support"></a>* Hardware support</h5><blockquote>
<p>è¿™ä¸€æ®µçœ‹æ˜ç™½äº†ä»–åœ¨è®²ä»€ä¹ˆï¼Œä½†æ˜¯ä¸æ˜¯ç‰¹åˆ«èƒ½å¤Ÿç†è§£ï¼Œä»¥åå¯èƒ½ä¼šå›æ¥å†çœ‹çœ‹</p>
</blockquote>
<p>Part 1 P78</p>
<p>å†…æ ¸çš„å¦ä¸€é¡¹ä¸»è¦å·¥ä½œæ˜¯å°†executiveå’Œè®¾å¤‡é©±åŠ¨ç¨‹åºä»Windowsæ”¯æŒçš„ç¡¬ä»¶æ¶æ„ä¹‹é—´çš„å˜åŒ–ä¸­æŠ½è±¡ã€éš”ç¦»å‡ºæ¥</p>
<h4 id="Hardware-abstraction-layer"><a href="#Hardware-abstraction-layer" class="headerlink" title="Hardware abstraction layer"></a>Hardware abstraction layer</h4><p>HALå¯¹ç¡¬ä»¶è®¿é—®è¿›è¡Œäº†æŠ½è±¡ï¼Œä¸ºä¾èµ–äºç‰¹å®šæ¶æ„æˆ–ä¾èµ–äºç‰¹å®šæœºå™¨çš„åŠŸèƒ½æä¾›äº†ç»Ÿä¸€çš„æ¥å£ï¼Œä¾‹å¦‚</p>
<ul>
<li>I/O interface</li>
<li>interrupt controllers</li>
<li>multiprocessor communication mechanisms</li>
</ul>
<p>é€šè¿‡HALæä¾›çš„ä¾‹ç¨‹è®¿é—®ç¡¬ä»¶å¯ä»¥ä¿è¯ä»£ç çš„å¯ç§»æ¤æ€§</p>
<p>x86æ¶æ„ä¸‹æä¾›ä¸¤ä¸ªHALæ–‡ä»¶ï¼ŒHalacpi.dllå’ŒHalmacpi.dllï¼Œåœ¨Windowså¯åŠ¨æ—¶ä¼šè‡ªè¡Œå†³å®šåº”å½“ä½¿ç”¨å“ªä¸€ä¸ª</p>
<table>
<thead>
<tr>
<th>HAL File Name</th>
<th>Systems Supported</th>
</tr>
</thead>
<tbody><tr>
<td>Halacpi.dll</td>
<td>Advanced Configuration and Power Interface (ACPI) PCs. åªæœ‰ä¸€ä¸ªæ ¸å¿ƒä¸”ä¸æ”¯æŒAPIC</td>
</tr>
<tr>
<td>Halmacpi.dll</td>
<td>Advanced Programmable Interrupt Controller (APIC) PCs with an ACPI. æ”¯æŒAPICæ„å‘³ç€æ”¯æŒSMP</td>
</tr>
</tbody></table>
<p>x64å’Œarmæ¶æ„ä¸‹å› ä¸ºå¤„ç†å™¨éœ€è¦ACPIå’ŒAPICæ”¯æŒï¼Œæ‰€ä»¥åªæœ‰ä¸€ä¸ªHAL</p>
<p>Windowsä½¿ç”¨HALæ‰©å±•æ¨¡å—å¯¹ä¸åŒç¡¬ä»¶æä¾›æ”¯æŒï¼Œä¾‹å¦‚Intel DMA controllerå¯èƒ½ä¸ä¼šå‡ºç°åœ¨æŸä¸ªç‰¹å®šçš„è®¾å¤‡ä¸Šï¼Œæˆ–è€…æœ‰æ—¶éœ€è¦å¯¹ä¸åŒçš„controlleræä¾›æ”¯æŒï¼Œ</p>
<h4 id="Device-drivers"><a href="#Device-drivers" class="headerlink" title="Device drivers"></a>Device drivers</h4><p>è®¾å¤‡é©±åŠ¨æ˜¯è¿æ¥I/Oç®¡ç†å™¨ä¸ç›¸å…³ç¡¬ä»¶çš„å¯è½½å…¥å†…æ ¸æ¨¡å—ï¼Œä»–ä»¬åœ¨å†…æ ¸ä¸­ä¼šä»¥ä¸€ä¸‹ä¸‰ç§ä¸Šä¸‹æ–‡ä¹‹ä¸€è¿è¡Œ</p>
<ul>
<li>ç”¨æˆ·çº¿ç¨‹å‘èµ·è°ƒç”¨äº†I/Oå‡½æ•°</li>
<li>å†…æ ¸æ¨¡å¼ç³»ç»Ÿçº¿ç¨‹(ä¾‹å¦‚æ¥è‡ªPnPç®¡ç†å™¨çš„è¯·æ±‚)</li>
<li>ç”±äºä¸­æ–­çš„å‡ºç°ï¼Œä»è€Œä¸åœ¨æŸä¸€å…·ä½“çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ä¸­</li>
</ul>
<p>Windowsè®¾å¤‡é©±åŠ¨å¹¶ä¸ç›´æ¥æ“ä½œç¡¬ä»¶ï¼Œè€Œæ˜¯é€šè¿‡è°ƒç”¨HALå†…çš„å‡½æ•°ä¸ç¡¬ä»¶äº¤äº’</p>
<p>è®¾å¤‡é©±åŠ¨åˆ†ä¸ºä»¥ä¸‹å‡ ç±»</p>
<ul>
<li><strong>Hardware device drivers</strong> åˆ©ç”¨HALæ“æ§ç¡¬ä»¶æ¥å‘ç‰©ç†ç¡¬ä»¶æˆ–ç½‘ç»œå†™å‡ºè¾“å‡ºæˆ–è€…æŸ¥è¯¢è¾“å…¥</li>
<li><strong>File system drivers</strong> æ¥å—é¢å‘æ–‡ä»¶çš„I/Oè¯·æ±‚å¹¶æŠŠå®ƒä»¬ç¿»è¯‘ä¸ºä¸ç‰¹å®šè®¾å¤‡å…³è”çš„I/Oè¯·æ±‚</li>
<li><strong>File system filter drivers</strong> æ‰§è¡Œç£ç›˜é•œåƒå’ŒåŠ å¯†ï¼Œæˆ–æ‰«æå®šä½ç—…æ¯’ç¨‹åºï¼Œæ‹¦æˆªI/Oè¯·æ±‚</li>
<li><strong>Network redirectors and servers</strong> è¿™æ˜¯å°†æ–‡ä»¶ç³»ç»ŸI/Oè¯·æ±‚ä¼ è¾“åˆ°ç½‘ç»œä¸Šçš„è®¡ç®—æœºä¸­çš„æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨</li>
<li><strong>Protocol drivers</strong> å®ç°ç½‘ç»œåè®®</li>
<li><strong>Kernel streaming filter drivers</strong> è¿™äº›é©±åŠ¨é“¾æ¥åœ¨ä¸€èµ·ç”¨æ¥åœ¨æ•°æ®æµä¸Šè¿›è¡Œä¿¡å·å¤„ç†</li>
<li><strong>Software drivers</strong> è¿™äº›å†…æ ¸é©±åŠ¨ä¸ºæŸäº›ç”¨æˆ·æ¨¡å¼è¿›ç¨‹æ‰§è¡Œä¸€äº›åªèƒ½åœ¨å†…æ ¸æ¨¡å¼ä¸‹å®Œæˆçš„æ“ä½œ</li>
</ul>
<h5 id="Windows-driver-model"><a href="#Windows-driver-model" class="headerlink" title="Windows driver model"></a>Windows driver model</h5><p>WDMå°†é©±åŠ¨åˆ†ä¸ºä¸‰å¤§ç±»</p>
<ul>
<li><strong>Bus drivers</strong> æ€»çº¿é©±åŠ¨ä¸ºæ€»çº¿æ§åˆ¶å™¨ã€é€‚é…å™¨ã€æ¡¥æˆ–è€…ä»»ä½•æ‹¥æœ‰å­è®¾å¤‡çš„è®¾å¤‡æä¾›æœåŠ¡ï¼Œæ€»çº¿é©±åŠ¨æ˜¯å¿…å¤‡çš„é©±åŠ¨ï¼Œæ¯ä¸€ç§æ€»çº¿éƒ½æœ‰ä¸€ä¸ªæ€»çº¿é©±åŠ¨</li>
<li><strong>Function drivers</strong> åŠŸèƒ½é©±åŠ¨æ˜¯è®¾å¤‡é©±åŠ¨çš„ä¸»é©±åŠ¨ï¼Œå¹¶ä¸”ä¸ºè®¾å¤‡æä¾›å¯æ“ä½œç•Œé¢</li>
<li><strong>Filter drivers</strong> è¿‡æ»¤é©±åŠ¨ç¨‹åºä¸ºä¸€ä¸ªè®¾å¤‡æˆ–ç°å­˜çš„é©±åŠ¨å¢åŠ æ›´å¤šçš„åŠŸèƒ½ï¼Œæˆ–è€…å»ä¿®æ”¹å…¶å®ƒé©±åŠ¨å‘å‡ºçš„è¯·æ±‚ä»¥åŠæ”¶åˆ°çš„å“åº”</li>
</ul>
<p>Windows Driver Foundation (WDF) æä¾›äº†KMDFå’ŒUMDFæ¥ç®€åŒ–é©±åŠ¨å¼€å‘</p>
<h5 id="Routine-Commonly-Used-Prefixes"><a href="#Routine-Commonly-Used-Prefixes" class="headerlink" title="Routine Commonly Used Prefixes"></a>Routine Commonly Used Prefixes</h5><p>Windowså†…æ ¸ç»„ä»¶å¯¼å‡ºå‡½æ•°çš„å‰ç¼€éƒ½æ˜¯æœ‰è§„å¾‹å¯å¾ªçš„ï¼Œå…·ä½“å¸¸ç”¨å‰ç¼€è¡¨è§Part 1 p87</p>
<p>åŒæ—¶è¿™äº›ç»„ä»¶ä¹Ÿä¼šä½¿ç”¨è¿™äº›å‰ç¼€çš„å˜ä½“æ¥æ ‡è¯†å†…éƒ¨å‡½æ•°ï¼Œä¾‹å¦‚ç”¨å‰ç¼€çš„ç¬¬ä¸€ä¸ªå­—æ¯åŠ <strong>i</strong>(internal)æˆ–è€…ç”¨å‰ç¼€çš„å…¨æ‹¼ååŠ <strong>p</strong>(private)ï¼Œä¾‹å¦‚</p>
<ul>
<li>KeæŒ‡Kernelï¼Œè€ŒKiæŒ‡å†…éƒ¨å†…æ ¸å‡½æ•°</li>
<li>PsæŒ‡Process supportï¼ŒPspæŒ‡å†…éƒ¨è¿›ç¨‹æ”¯æŒå‡½æ•°</li>
</ul>
<p>å‡½æ•°çš„å‘½åæ–¹å¼ä¸º<code>&lt;Prefix&gt;&lt;Operation&gt;&lt;Object&gt;</code>ï¼Œä¾‹å¦‚<code>ExAllocatePoolWithTag</code></p>
<h4 id="System-processes"><a href="#System-processes" class="headerlink" title="System processes"></a>System processes</h4><p><img src="/2022/07/12/WindowsInternal/../WindowsInternal/image-20220713154525054.png" alt="image-20220713154525054"></p>
<h5 id="System-idle-process"><a href="#System-idle-process" class="headerlink" title="System idle process"></a>System idle process</h5><p>è¯¥è¿›ç¨‹æ²¡æœ‰å¯¹åº”çš„ç”¨æˆ·æ€å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿›ç¨‹IDä¸º0</p>
<p>è¿™ä¸ªè¿›ç¨‹å†…çº¿ç¨‹çš„æ•°é‡ä¸é€»è¾‘CPUçš„æ•°ç›®ç›¸ç­‰ï¼Œè¯¥è¿›ç¨‹ç”¨äºç»Ÿè®¡ç©ºé—²æ—¶é—´</p>
<h5 id="System-process-and-system-threads"><a href="#System-process-and-system-threads" class="headerlink" title="System process and system threads"></a>System process and system threads</h5><blockquote>
<p>è¿™é‡Œçš„System processæŒ‡PIDä¸º4åç§°ä¸ºSystemçš„è¿›ç¨‹</p>
</blockquote>
<p>è¯¥è¿›ç¨‹æ˜¯æ‰€æœ‰å†…æ ¸æ¨¡å¼çº¿ç¨‹(ä¸€ç§ä»…è¿è¡Œåœ¨å†…æ ¸æ€çš„çº¿ç¨‹)çš„å®¶ï¼Œç³»ç»Ÿçº¿ç¨‹æ‹¥æœ‰æ‰€æœ‰å¸¸è§„ç”¨æˆ·æ€çº¿ç¨‹æ‹¥æœ‰çš„å±æ€§å’Œä¸Šä¸‹æ–‡ï¼Œä¾‹å¦‚ç¡¬ä»¶ä¸Šä¸‹æ–‡ã€ä¼˜å…ˆçº§ç­‰ï¼Œä½†ä¸åŒçš„æ˜¯ç³»ç»Ÿçº¿ç¨‹ä»…è¿è¡Œå†…æ ¸æ¨¡å¼çš„ä»£ç ï¼Œä¸”æ²¡æœ‰ç”¨æˆ·æ¨¡å¼å†…å­˜ç©ºé—´ï¼Œå› æ­¤åªèƒ½ä»OSå†…å­˜å †ä¸­åˆ†é…åŠ¨æ€å†…å­˜</p>
<p>ç³»ç»Ÿçº¿ç¨‹é€šè¿‡PsCreateSystemThreadæˆ–è€…IoCreateSystemThreadå‡½æ•°åˆ›å»ºï¼ŒWindowsæˆ–å…¶ä»–è®¾å¤‡é©±åŠ¨åœ¨ç³»ç»Ÿåˆå§‹åŒ–æ—¶åˆ›å»ºç³»ç»Ÿçº¿ç¨‹æ¥æ‰§è¡Œéœ€è¦çº¿ç¨‹ä¸Šä¸‹æ–‡çš„æ“ä½œï¼Œä¾‹å¦‚å‘å‡ºæˆ–ç­‰å¾…I/OåŠå…¶å®ƒå¯¹è±¡ï¼Œæˆ–è€…è¿›è¡Œè®¾å¤‡è½®è¯¢</p>
<h5 id="Memory-Compression-process"><a href="#Memory-Compression-process" class="headerlink" title="* Memory Compression process"></a>* Memory Compression process</h5><p>å†…å­˜å‹ç¼©è¿›ç¨‹ä½¿ç”¨å…¶ç”¨æˆ·æ¨¡å¼åœ°å€ç©ºé—´æ¥å­˜å‚¨ä¸å·²ä»æŸäº›è¿›ç¨‹çš„å·¥ä½œé›†ä¸­é€å‡ºçš„å¤‡ç”¨å†…å­˜ç›¸å¯¹åº”çš„å‹ç¼©å†…å­˜é¡µ(æœºç¿»æ²¡å¤ªçœ‹æ˜ç™½ï¼Œçœ‹åŸæ–‡ä¹Ÿæ²¡å¤ªçœ‹æ˜ç™½ï¼Œå¯èƒ½åˆ°æ—¶å€™å›æ¥å†çœ‹çœ‹)</p>
<h5 id="Session-Manager"><a href="#Session-Manager" class="headerlink" title="Session Manager"></a>Session Manager</h5><p>æ‰§è¡Œkernelå’Œexecutiveåˆå§‹åŒ–æœ€ç»ˆé˜¶æ®µçš„å†…æ ¸æ¨¡å¼ç³»ç»Ÿçº¿ç¨‹åˆ›å»ºäº†è¿™ä¸ªè¿›ç¨‹</p>
<p>ä¸»Smss.exeä¼šæŸ¥è¯¢å¤§é‡æ³¨å†Œè¡¨ä¿¡æ¯å®Œæˆä¸€ç³»åˆ—åˆå§‹åŒ–æ“ä½œ(è§Part1 P92)ï¼Œåœ¨æœ€åä¼šåˆ›å»ºå­Smss.exeå®ä¾‹æ¥åˆå§‹åŒ–session 0ä»¥åŠsession 1</p>
<p>å­Smss.exeåœ¨å®Œæˆåˆå§‹åŒ–ä¹‹åä¼šé€€å‡ºæ‰§è¡Œï¼Œåªæœ‰ä¸»è¿›ç¨‹ä¼šä¿æŒæ‰§è¡Œ</p>
<h5 id="Windows-initialization-process"><a href="#Windows-initialization-process" class="headerlink" title="Windows initialization process"></a>Windows initialization process</h5><p>åŒæ ·ä¹Ÿå®Œæˆäº†å¤§é‡åˆå§‹åŒ–æ“ä½œï¼Œåˆ›å»ºäº†ä¸€äº›äº‹ä»¶å¯¹è±¡ï¼Œè®¾ç½®äº†ä¸€äº›åŸºæœ¬å˜é‡ï¼Œåˆå§‹åŒ–äº†service control manager</p>
<h5 id="Service-Control-Manager"><a href="#Service-Control-Manager" class="headerlink" title="Service Control Manager"></a>Service Control Manager</h5><p>Windowsä¸‹çš„æœåŠ¡ç±»ä¼¼äºLinuxçš„å®ˆæŠ¤è¿›ç¨‹ï¼Œå¯ä»¥è®¾ç½®ä»–ä»¬åœ¨Windowså¯åŠ¨æ—¶è‡ªåŠ¨å¯åŠ¨</p>
<p>SCMæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ç³»ç»Ÿè¿›ç¨‹ï¼Œå®ƒè´Ÿè´£å¯åŠ¨ã€åœæ­¢ä»¥åŠä¸æœåŠ¡è¿›ç¨‹äº¤äº’ï¼›æœåŠ¡ç¨‹åºå®é™…ä¸Šä¹Ÿåªæ˜¯ä¼šè°ƒç”¨Windowså‡½æ•°ä¸SCMäº¤äº’çš„ç‰¹æ®Šçš„Windows image</p>
<p>æœåŠ¡ä¸æœåŠ¡è¿›ç¨‹å¹¶éä¸€å¯¹ä¸€å…³ç³»ï¼Œéƒ¨åˆ†æœåŠ¡ä¼šå…±äº«ä¸€ä¸ªè¿›ç¨‹</p>
<h5 id="Winlogon-LogonUI-and-Userinit"><a href="#Winlogon-LogonUI-and-Userinit" class="headerlink" title="Winlogon, LogonUI, and Userinit"></a>Winlogon, LogonUI, and Userinit</h5><p>Winlogonç”±åˆå§‹åŒ–sessionçš„Smss.exeè°ƒç”¨ï¼Œå®ƒè´Ÿè´£ä¸ç”¨æˆ·äº¤äº’å®ç°ç™»å½•å’Œç™»å‡ºï¼Œå½“ç”¨æˆ·æŒ‰ä¸‹secure attention sequence (SAS) é”®ç›˜ç»„åˆæ—¶ï¼ŒWinlogonå°±ä¼šæ¥æ”¶åˆ°è¿™ä¸ªä¿¡æ¯å¹¶ä¸”è¿›å…¥ç™»é™†ç•Œé¢ï¼Œé»˜è®¤SASç»„åˆæ˜¯Ctrl+Alt+Delï¼Œè¿™ä¸ªç»„åˆä¸èƒ½è¢«ç”¨æˆ·æ€åº”ç”¨æ‹¦æˆªï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šä¿éšœç”¨æˆ·ç™»å½•å®‰å…¨</p>
<p>å½“ç”¨æˆ·æˆåŠŸç™»å½•åï¼ŒLsass.exeä¼šä¸ºç”¨æˆ·ç”Ÿæˆåˆé€‚çš„è®¿é—®å‡­è¯å¯¹è±¡ï¼Œå¦‚æœç”¨æˆ·æ˜¯ç®¡ç†å‘˜ç”¨æˆ·ä¸”ç³»ç»Ÿå¯ç”¨äº†UACï¼Œé‚£ä¹ˆè¿˜ä¼šé¢å¤–ç”Ÿæˆä¸€ä¸ªå—é™çš„å‡­è¯ï¼›éšåWinlogonä¼šä½¿ç”¨å‡­è¯æ¥åˆ›å»ºç”¨æˆ·ä¼šè¯åˆå§‹åŒ–è¿›ç¨‹ï¼Œé»˜è®¤æ˜¯Userinit.exeï¼ŒUserinit.exeä¼šåœ¨åˆå§‹åŒ–ä¸€äº›ç¯å¢ƒåï¼Œè°ƒç”¨HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shellä¸­å­˜å‚¨çš„ç¨‹åº(é»˜è®¤æ˜¯explorer.exe)</p>
<h2 id="CHAPTER-3-Processes-and-jobs"><a href="#CHAPTER-3-Processes-and-jobs" class="headerlink" title="CHAPTER 3 Processes and jobs"></a>CHAPTER 3 Processes and jobs</h2><h3 id="Creating-a-process"><a href="#Creating-a-process" class="headerlink" title="Creating a process"></a>Creating a process</h3><p>åˆ›å»ºè¿›ç¨‹çš„Windows API</p>
<ul>
<li>CreateProcess  åˆ›å»ºä¸è°ƒç”¨è¿›ç¨‹æ‹¥æœ‰ç›¸åŒè®¿é—®ä»¤ç‰Œçš„è¿›ç¨‹</li>
<li>CreateProcessAsUser  ä½¿ç”¨é¢å¤–çš„è®¿é—®ä»¤ç‰Œåˆ›å»ºè¿›ç¨‹</li>
<li>CreateProcessWithTokenW</li>
<li>CreateProcessWithLogonW</li>
</ul>
<p>åé¢ä¸¤ä¸ªAPIå‡æ¥è‡ªadvapi32.dllï¼ŒCreateProcessWithTokenWå’ŒCreateProcessAsUserç±»ä¼¼ï¼Œå‡æ¥å—ä¸€ä¸ªHANDLEä½œä¸ºç”¨æˆ·Tokenï¼Œå¹¶ä»¥è¯¥ç”¨æˆ·çš„èº«ä»½åˆ›å»ºè¿›ç¨‹ï¼ŒäºŒè€…çš„å·®åˆ«æ˜¯å¯¹ä¸»è°ƒè¿›ç¨‹çš„æƒé™è¦æ±‚ä¸åŒï¼ŒäºŒè€…ä¼šé€šè¿‡å‘å‡ºRPC(remote procedure call)è¯·æ±‚è°ƒç”¨Secondary LogonæœåŠ¡</p>
<p>ä¸Šè¿°å››ä¸ªä¾‹ç¨‹éƒ½éœ€è¦ä¸€ä¸ªå¯è¿è¡Œæ–‡ä»¶æ¥åˆ›å»ºè¿›ç¨‹ï¼ŒWindowsè¿˜æä¾›äº†ShellExecute(Ex)æ¥é’ˆå¯¹ç‰¹å®šçš„æ–‡ä»¶æ‰§è¡Œâ€openâ€æ“ä½œï¼ŒWindowsä¼šæŸ¥æ‰¾æ³¨å†Œè¡¨ä¸­çš„æ‰©å±•åå…³è”ä¿¡æ¯ï¼Œå¯åŠ¨åˆé€‚çš„æ–‡ä»¶ï¼Œæœ€ç»ˆä¹Ÿä¼šè°ƒç”¨CreateProcessæ¥åˆ›å»ºè¿›ç¨‹</p>
<p>æ‰€æœ‰çš„è¿›ç¨‹åˆ›å»ºæœ€ç»ˆéƒ½ä¼šè°ƒç”¨ntdll.dllé‡Œçš„NtCreateUserProcessåˆ‡æ¢åˆ°å†…æ ¸æ€å®Œæˆå†…æ ¸ä¸­çš„ç”¨æˆ·è¿›ç¨‹åˆ›å»ºå·¥ä½œ</p>
<p>å…¶ä»–ä»»ä½•å½¢å¼çš„è¿›ç¨‹çš„åˆ›å»ºï¼ŒåŒ…æ‹¬UWPã€native processã€pico processä»¥åŠä¸€äº›ç³»ç»Ÿè¿›ç¨‹(æ²¡æœ‰å…·ä½“çš„é•œåƒçš„è¿›ç¨‹, minimal)è¿™äº›ï¼Œæœ€ç»ˆéƒ½ä¼šåœ¨ç”¨æˆ·æ€è°ƒç”¨NtCreateUserProcessæˆ–NtCreateUserProcessExï¼Œè€Œè¿™ä¸¤è€…è™½ç„¶æ˜¯ä¸åŒçš„ç³»ç»Ÿè°ƒç”¨ï¼Œä½†ä»–ä»¬åœ¨è¿›å…¥å†…æ ¸æ€ä¹‹åå´ä½¿ç”¨äº†åŒä¸€ä¸ªä¾‹ç¨‹æ¥å®Œæˆå†…æ ¸æ€çš„å·¥ä½œ</p>
<h3 id="Process-internals"><a href="#Process-internals" class="headerlink" title="Process internals"></a>Process internals</h3><p>æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½ä¼šè¢«ä¸€ä¸ªEPROCESSç»“æ„ä½“æ‰€ä»£è¡¨ï¼Œè¯¥è¿›ç¨‹åŒ…å«äº†è®¸å¤šè¿›ç¨‹ç›¸å…³çš„å±æ€§ä»¥åŠæŒ‡å‘ä¸è¿›ç¨‹ç›¸å…³ç»“æ„ä½“çš„æŒ‡é’ˆ</p>
<p>ä¾‹å¦‚EPROCESS::Win32PROCESSï¼Œè¿™æ˜¯ä¸€ä¸ªæŒ‡å‘W32PROCESSçš„æŒ‡é’ˆï¼Œåè€…æ˜¯Win32k.sysç”¨äºç»´æŠ¤windows subsystemçš„ç»“æ„ä½“ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯åœ¨éWindows Subsystemè¿›ç¨‹(ä¾‹å¦‚native processï¼Œsmss.exe)çš„EPROCESSå†…è¯¥æŒ‡é’ˆå€¼ä¸ºnull</p>
<p>å†…æ ¸é©±åŠ¨å¯ä»¥ä½¿ç”¨PsSetCreateProcessNotifyRoutine(Ex, Ex2)ä¾‹ç¨‹æ¥åœ¨è¿›ç¨‹åˆ›å»ºæ—¶æ‰§è¡Œä¸€äº›æ“ä½œ(ä¾‹å¦‚åˆ›å»ºä¸€ä¸ªç”¨äºè®°å½•è¿›ç¨‹ä¿¡æ¯çš„ç»“æ„ä½“)</p>
<p>EPROCESSçš„ç¬¬ä¸€ä¸ªæˆå‘˜Process Control Block(PCB)æ˜¯KPROCESSçš„ç»“æ„ä½“å¯¹è±¡ï¼Œkernelå†…æ ¸å±‚ä¼šä½¿ç”¨è¯¥å¯¹è±¡æ¥å®Œæˆä¸€ç³»åˆ—æ“ä½œï¼Œå°†EPROCESSå’ŒKPROCESSåŒºåˆ†å¼€æ˜¯ä¸ºäº†ä¿æŒä¸€å®šç¨‹åº¦ä¸Šçš„æŠ½è±¡</p>
<p>EPROCESSä¸­æœ‰ä¸€ä¸ªActive Process Linkï¼Œå®ƒæ˜¯ä¸€ä¸ªç”±nt!PsActiveProcessHeadä¸ºè¡¨å¤´ç»„æˆçš„åŒå‘é“¾è¡¨ï¼Œé“¾æ¥èµ·äº†ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ´»è·ƒè¿›ç¨‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é“¾è¡¨ä¸­çš„FLINKå’ŒBLINKæŒ‡å‘çš„æ˜¯ä¸´è¿‘èŠ‚ç‚¹ä¸­å¯¹åº”çš„Active Process Linkï¼Œè€ŒéEPROCESS</p>
<p><img src="/2022/07/12/WindowsInternal/../WindowsInternal/eprocess.drawio.png" alt="eprocess.drawio"></p>
<p>ç»è¿‡è‡ªå·±å®éªŒï¼Œnt!PsActiveProcessHeadå®é™…ä¸ŠæŒ‡å‘System(PIDä¸º4)çš„EPROCESSçš„Active Process Linkç»“æ„</p>
<p><img src="/2022/07/12/WindowsInternal/../WindowsInternal/image-20220720095310136.png" alt="image-20220720095310136"></p>
<p>EPROCESSä»¥åŠè¿›ç¨‹ç›¸å…³çš„ç»“æ„ä½“å¤§éƒ½å­˜æ”¾åœ¨å†…æ ¸ç©ºé—´ä¸­ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªä¾‹å¤–ï¼ŒProcess Environment Block(PEB)å­˜æ”¾äºç”¨æˆ·ç©ºé—´ä¸­ï¼ŒEPROCESSä¸­çš„PEBæˆå‘˜æŒ‡å‘è¯¥ç»“æ„ä½“(system:4çš„EPROCESS.Pebä¸ºNULL)</p>
<h3 id="Protected-process"><a href="#Protected-process" class="headerlink" title="Protected process"></a>Protected process</h3><p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ‹¥æœ‰è°ƒè¯•æƒé™çš„è¿›ç¨‹å¯ä»¥å®Œå…¨è®¿é—®æ­¤è®¡ç®—æœºä¸Šçš„ä»»æ„å…¶ä»–è¿›ç¨‹ï¼Œä½†ä¸ºäº†èƒ½åœ¨è¿åˆæ•°å­—ç‰ˆæƒè¦æ±‚çš„å‰æä¸‹åœ¨Windowsä¸Šæ’­æ”¾è“å…‰ä¹‹ç±»çš„åª’ä½“å½±ç‰‡ï¼ŒWindowsæ¨å‡ºäº†protected process</p>
<p>åªæœ‰è·å–äº†ç‰¹æ®Šç­¾åçš„åº”ç”¨ç¨‹åºæ‰èƒ½è¢«åˆ›å»ºä¸ºä¿æŠ¤è¿›ç¨‹ï¼Œä¿æŠ¤è¿›ç¨‹çš„EPROCESSä¸­ä¼šè®¾ç½®ä¸€ä¸ªç‰¹æ®Šçš„ä½ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›å®‰å…¨ç›¸å…³çš„è¿›ç¨‹æ‹’ç»æä¾›ä¿æŠ¤è¿›ç¨‹çš„éƒ¨åˆ†æƒé™ï¼›å®é™…ä¸Šå¯¹äºä¿æŠ¤è¿›ç¨‹èƒ½å¤Ÿè·å–çš„æƒé™ä»…æœ‰</p>
<ul>
<li>PROCESS_QUERY/SET_LIMITED_INFOMATION</li>
<li>PROCESS_TERMINATE</li>
<li>PROCESS_SUSPEND_RESUME</li>
</ul>
<h4 id="Protected-Process-Light-PPL"><a href="#Protected-Process-Light-PPL" class="headerlink" title="Protected Process Light (PPL)"></a>Protected Process Light (PPL)</h4><p>PPLæœºåˆ¶ä½è¿›ç¨‹ä¿æŠ¤æ·»åŠ äº†ä¸€ç§ç­‰çº§å…³ç³»ï¼Œä¸åŒçš„Signers(è¿™é‡Œåº”è¯¥ç†è§£ä¸ºä¸ºimageç­¾å‘è¯ä¹¦çš„äºº)æ‹¥æœ‰ä¸åŒçš„ä¿¡ä»»çº§åˆ«ï¼Œè¿™å¯¼è‡´äº†ä¸åŒç­‰çº§çš„ä¿æŠ¤è¿›ç¨‹ä¹‹é—´å—ä¿æŠ¤çš„ç¨‹åº¦ä¸åŒ</p>
<p>åŒæ—¶PPLå¯ä»¥è®©Signerså®šä¹‰å“ªäº›è®¿é—®æƒé™ä¸èƒ½è¢«è¾ƒä½ä¿æŠ¤ç­‰çº§çš„è¿›ç¨‹è·å–ï¼Œä¾‹å¦‚å¯ä»¥æ‹’ç»è¾ƒä½ä¿æŠ¤ç­‰çº§çš„è¿›ç¨‹è·å–ä¿æŠ¤è¿›ç¨‹çš„PROCESS_TERMINATEæƒé™</p>
<table>
<thead>
<tr>
<th>Internal Protection Process Level Symbol</th>
<th>Level</th>
<th>Protection Type</th>
<th>Signer</th>
</tr>
</thead>
<tbody><tr>
<td>PS_PROTECTED_SYSTEM</td>
<td>0x72</td>
<td>Protected</td>
<td>WinSystem</td>
</tr>
<tr>
<td>PS_PROTECTED_WINTCB</td>
<td>0x62</td>
<td>Protected</td>
<td>WinTcb</td>
</tr>
<tr>
<td>PS_PROTECTED_WINTCB_LIGHT</td>
<td>0x61</td>
<td>Protected Light</td>
<td>WinTcb</td>
</tr>
<tr>
<td>PS_PROTECTED_WINDOWS</td>
<td>0x52</td>
<td>Protected</td>
<td>Windows</td>
</tr>
<tr>
<td>PS_PROTECTED_WINDOWS_LIGHT</td>
<td>0x51</td>
<td>Protected Light</td>
<td>Windows</td>
</tr>
<tr>
<td>PS_PROTECTED_LSA_LIGHT</td>
<td>0x41</td>
<td>Protected Light</td>
<td>Lsa</td>
</tr>
<tr>
<td>PS_PROTECTED_ANTIMALWARE_LIGHT</td>
<td>0x31</td>
<td>Protected Light</td>
<td>Anti-malware</td>
</tr>
<tr>
<td>PS_PROTECTED_AUTHENTICODE</td>
<td>0x21</td>
<td>Protected</td>
<td>Authenticode</td>
</tr>
<tr>
<td>PS_PROTECTED_AUTHENTICODE_LIGHT</td>
<td>0x11</td>
<td>Protected Light</td>
<td>Authenticode</td>
</tr>
<tr>
<td>PS_PROTECTED_NONE</td>
<td>0x00</td>
<td>None</td>
<td>None</td>
</tr>
</tbody></table>
<ul>
<li>åŒä¸€ä¸ªSingerç­¾ç½²çš„è¿›ç¨‹ä¸­ï¼ŒProtected &gt; Protected Light</li>
<li>é«˜çº§åˆ«çš„ä¿æŠ¤è¿›ç¨‹å¯ä»¥è®¿é—®ä½çº§åˆ«çš„ä¿æŠ¤è¿›ç¨‹</li>
</ul>
<p>ä¸€ä¸ªé•œåƒæ–‡ä»¶çš„ä¿æŠ¤ç­‰çº§ä¸ä»…å–å†³äºç­¾å‘è€…ï¼Œè¿˜å–å†³äºè¯ä¹¦ä¸­EKUçš„å€¼</p>
<p>ä¸€ä¸ªå—ä¿æŠ¤çš„è¿›ç¨‹åŠ è½½DLLæ—¶ï¼Œè¯¥DLLä¹Ÿä¼šæ”¶åˆ°ç›¸åº”çš„å®¡æŸ¥ï¼Œåªæœ‰å…·å¤‡é€‚å½“ç­¾åçš„DLLæ‰èƒ½è¢«åŠ è½½è¿›ä¿æŠ¤è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­</p>
<p>ä¸€äº›Windowså…³é”®è¿›ç¨‹ä¼šè¢«è¦æ±‚ä»¥æŸä¸€æœ€ä½ä¿æŠ¤ç­‰çº§æ¥å¯åŠ¨è¿è¡Œï¼Œè¯¦è§part1 p118</p>
<h4 id="Third-party-PPL-support"><a href="#Third-party-PPL-support" class="headerlink" title="Third-party PPL support"></a>Third-party PPL support</h4><p>é™¤äº†å¾®è½¯å®˜æ–¹ç­¾ç½²çš„ç³»ç»Ÿç»„ä»¶å¤–ï¼ŒPPLæœ€å¸¸è§çš„ç”¨é€”æ˜¯ç”¨äºæ€æ¯’è½¯ä»¶(åæ¶æ„è½¯ä»¶è½¯ä»¶ anti-malware software)ï¼Œæ€è½¯å¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆ</p>
<ul>
<li>é©±åŠ¨ æ‹¦æˆªæ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œçš„I/Oè¯·æ±‚ï¼Œå®ç°æ‹¦æˆªåŠŸèƒ½</li>
<li>ç”¨æˆ·æ¨¡å¼æœåŠ¡ é…ç½®é©±åŠ¨ã€ä¸é©±åŠ¨è¿›è¡Œé€šä¿¡ï¼Œæ¥å—é©±åŠ¨ä¸‹å‘çš„äº‹ä»¶</li>
<li>ç”¨æˆ·æ¨¡å¼GUIè¿›ç¨‹</li>
</ul>
<p>ç”¨æˆ·æ¨¡å¼æœåŠ¡è¿›ç¨‹éœ€è¦ä»¥PPLè¿è¡Œæ¥ä¿æŠ¤è‡ªèº«ï¼Œæ€è½¯é©±åŠ¨å†…å¯ä»¥å­˜æ”¾ä¸€äº›Singerä»¥åŠEKUä¿¡æ¯ï¼Œå½“ä»£ç å®Œæ•´æ€§ç³»ç»Ÿæ£€æŸ¥åˆ°æŸä¸ªæ–‡ä»¶å…·æœ‰è¿™äº›ä¿¡æ¯çš„æ—¶å€™ï¼Œå®ƒå°±ä¼šå…è®¸è¯¥è¿›ç¨‹ä»¥PPLè¿è¡Œ</p>
<h3 id="Minimal-and-Pico-process"><a href="#Minimal-and-Pico-process" class="headerlink" title="Minimal and Pico process"></a>Minimal and Pico process</h3><p>å¹¶éæ‰€æœ‰çš„è¿›ç¨‹éƒ½æ˜¯ä¸ºäº†æ‰§è¡Œç”¨æˆ·æ€çš„ä»£ç ï¼›ä¾‹å¦‚System processä»…ç”¨ä½œç»å¤§å¤šæ•°ç³»ç»Ÿçº¿ç¨‹ä»¥åŠé©±åŠ¨å¥æŸ„çš„å®¹å™¨</p>
<h4 id="Minimal-processes"><a href="#Minimal-processes" class="headerlink" title="Minimal processes"></a>Minimal processes</h4><p>å‘NtCreateProcessExä¼ é€’ç‰¹æ®Šçš„å‚æ•°å³å¯åˆ›å»ºminimal processï¼Œè¿™æ ·çš„è¿›ç¨‹ä¸å…·æœ‰è®¸å¤šæ­£å¸¸è¿›ç¨‹ç‹¬æœ‰çš„ç»“æ„</p>
<ul>
<li>ä¸ä¼šåˆ†é…ç”¨æˆ·æ¨¡å¼åœ°å€ç©ºé—´ï¼Œå› æ­¤ä¹Ÿæ²¡æœ‰PEB</li>
<li>NTDLLä¸ä¼šè¢«æ˜ å°„åˆ°è¿›ç¨‹ä¸­ï¼Œä¹Ÿä¸ä¼šæœ‰ä»»ä½•åŠ è½½å™¨/API Setä¿¡æ¯</li>
<li>æ²¡æœ‰sectionå¯¹è±¡ä¸è¿›ç¨‹ç»‘å®šï¼Œè¿™æ„å‘³ç€æ²¡æœ‰å¯æ‰§è¡Œæ–‡ä»¶é•œåƒä¸è¯¥è¿›ç¨‹å…³è”</li>
<li>EPROCESSä¼šè®¾ç½®ç‰¹æ®Šçš„æ ‡å¿—ï¼Œè¿™ä¼šå¯¼è‡´æ‰€æœ‰çš„çº¿ç¨‹ä¹Ÿæˆä¸ºminimal thread</li>
</ul>
<h4 id="Pico-processes"><a href="#Pico-processes" class="headerlink" title="Pico processes"></a>Pico processes</h4><p>Pico providerå¿…é¡»åœ¨æ‰€æœ‰å…¶ä»–ç¬¬ä¸‰æ–¹é©±åŠ¨ä¹‹å‰åŠ è½½ï¼Œè€Œä¸”åªæœ‰å°‘æ•°åä½™ä¸ªæ ¸å¿ƒé©±åŠ¨å…è®¸è°ƒç”¨PsRegisterPicoProvider</p>
<p>åœ¨æ³¨å†ŒPico Provideræ—¶ï¼Œå†…æ ¸ä¼šå‘Pico Provideræä¾›ä¸€ç³»åˆ—å‡½æ•°ç”¨äºç®¡ç†Pico processï¼ŒåŒæ—¶Pico Providerä¹Ÿä¼šå‘å†…æ ¸æäº¤ä¸€ç³»åˆ—å‡½æ•°ç”¨ä½œæ¥ç®¡Pico Processè§¦å‘çš„ä¸€ç³»åˆ—äº‹ä»¶</p>
<p>Pico Provideræœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®ç°äº†ä¸€ç³»åˆ—é‡è¦å›è°ƒå‡½æ•°çš„å†…æ ¸æ¨¡å—ï¼Œè¿™äº›å›è°ƒå‡½æ•°èƒ½å¤Ÿå“åº”Pico processè§¦å‘çš„ä¸€ç³»åˆ—äº‹ä»¶</p>
<h3 id="Trustlets-secure-processes-æœ¬ç« æœªä»”ç»†é˜…è¯»"><a href="#Trustlets-secure-processes-æœ¬ç« æœªä»”ç»†é˜…è¯»" class="headerlink" title="Trustlets (secure processes) (æœ¬ç« æœªä»”ç»†é˜…è¯»)"></a>Trustlets (secure processes) (æœ¬ç« æœªä»”ç»†é˜…è¯»)</h3><p>trustletsè¿è¡Œåœ¨VTL 1ä¸­ï¼ŒVTL 1çš„ring 3è¿›ç¨‹ä¹Ÿå¯ä»¥é¿å…æ¥è‡ªVTL 0çš„ring 0åŠring 3ä»£ç çš„è®¿é—®</p>
<p>trustletsåªèƒ½å¯¼å…¥ç‰¹å®šçš„è‹¥å¹²DLLï¼Œå®ƒä»¬èƒ½ä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨ä¹Ÿæœ‰é™åˆ¶ï¼ŒåŒæ—¶å®ƒä»¬çš„é•œåƒæ–‡ä»¶ä¸­ä¼šæœ‰ä¸€ä¸ªç‰¹æ®Šçš„.tPolicyæ®µï¼Œé‡Œé¢æ˜¯ä¸€äº›å…³äºå¦‚ä½•å¤„ç†æ¥è‡ªVTL 0è®¿é—®çš„è®¾å®š</p>
<h3 id="Flow-of-CreateProcess"><a href="#Flow-of-CreateProcess" class="headerlink" title="Flow of CreateProcess"></a>Flow of CreateProcess</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2020/05/08/mc-PAPIJS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/05/08/mc-PAPIJS/" class="post-title-link" itemprop="url">PAPI-JavaScriptæ‰©å±•</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-05-08 13:17:01" itemprop="dateCreated datePublished" datetime="2020-05-08T13:17:01+00:00">2020-05-08</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MineCraft/" itemprop="url" rel="index"><span itemprop="name">MineCraft</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="å®æˆ˜æ•™ç¨‹-JavaScript-amp-PlaceholderAPI-ä»å…¥é—¨åˆ°ç²¾é€š"><a href="#å®æˆ˜æ•™ç¨‹-JavaScript-amp-PlaceholderAPI-ä»å…¥é—¨åˆ°ç²¾é€š" class="headerlink" title="[å®æˆ˜æ•™ç¨‹] JavaScript&amp;PlaceholderAPI ä»å…¥é—¨åˆ°ç²¾é€š"></a>[å®æˆ˜æ•™ç¨‹] JavaScript&amp;PlaceholderAPI ä»å…¥é—¨åˆ°ç²¾é€š</h1><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><ul>
<li>ä¸ºä»€ä¹ˆè¦å†™è¿™ç¯‡æ•™ç¨‹ï¼Ÿ<ul>
<li>ç«™å†…(æŒ‡MCBBSä¸­æ–‡è®ºå›)å·²ç»æœ‰<strong>ä¸¤ç¯‡</strong>ç›¸å…³çš„æ•™ç¨‹äº†ï¼Œä½†æ˜¯æˆ‘å‘ç°æœ‰äººçœ‹äº†è¿™äº›æ•™ç¨‹ä¹‹åï¼Œè¿˜æ˜¯ä¸€å¤´é›¾æ°´(è€Œä¸”ä»–ä»¬å¥½åƒéƒ½åœ¨å’•)ï¼Œä¸çŸ¥é“ä»ä½•åŠ¨æ‰‹ï¼Œè€Œä¸”ä»–ä»¬å¯¹äº<code>PlaceholderAPI JSæ‰©å±•</code>çš„ç²¾é«“éƒ½æ²¡æœ‰æ€ä¹ˆæåŠï¼Œå› æ­¤æˆ‘å†³å®šä»<strong>å®æˆ˜</strong>è§’åº¦å‡ºå‘ï¼Œè®¾ç«‹è‹¥å¹²æƒ…æ™¯ï¼Œæ—¨åœ¨å¸®åŠ©é‚£äº›è¿JSéƒ½ä¸æ€ä¹ˆä¼šçš„äººï¼Œèƒ½å¤Ÿç›´æ¥ä¾è‘«èŠ¦ç”»ç“¢è§£å†³ä»–ä»¬çš„é—®é¢˜ï¼›å¸®åŠ©é‚£äº›äº†è§£JSçš„äººå»æ¥è§¦<code>PlaceholderAPI JSæ‰©å±•</code>ä¸­æœ€å¼ºæœ€å¥½ç”¨çš„åŠŸèƒ½(å› ä¸ºæˆ‘å‘ç°å®˜æ–¹çš„wikié‡Œå‹æ ¹å°±æ²¡æœ‰è¯¦ç»†ä»‹ç»è¿‡è¿™äº›åŠŸèƒ½çš„ä½¿ç”¨)</li>
<li><strong>åªè¦æˆ‘ä¸€æ¬¡æ€§å†™å®Œï¼Œæˆ‘å°±èƒ½ä¿è¯æˆ‘ä¸ä¼šé¸½äº†ï¼ï¼</strong></li>
</ul>
</li>
<li>æœ¬æ•™ç¨‹çš„ç»“æ„ï¼Ÿ<ul>
<li>æœ¬æ•™ç¨‹åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯æ¯”è¾ƒè¯¦ç»†çš„åŸºç¡€ä»‹ç»ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯è‹¥å¹²ç§åœºæ™¯çš„å®æˆ˜æ•™ç¨‹ï¼Œæœ‰ä¸´æ—¶éœ€æ±‚çš„å°ç™½å¯ä»¥ç›´æ¥çœ‹å®æˆ˜éƒ¨åˆ†ï¼Œæ‰¾åˆ°è‡ªå·±éœ€è¦çš„ä»£ç æŠ„èµ°ä¿®æ”¹ã€‚ç¬¬ä¸‰éƒ¨åˆ†ä¸ºé«˜çº§ç”¨æ³•ï¼Œåˆ©ç”¨<code>JSå¼•æ“</code>çš„ç‰¹æ€§è°ƒç”¨<code>Java</code>ä¸­çš„ç±»</li>
</ul>
</li>
<li>è¿™ç¯‡æ•™ç¨‹çš„å—ä¼—æ˜¯ï¼Ÿ<ul>
<li>å®Œå…¨æ²¡æœ‰<code>JS</code>çŸ¥è¯†ï¼Œä½†æ˜¯æœ‰å­¦ä¹ åŠ¨åŠ›çš„å°ç™½ï¼Œæˆ‘ä¼šå°½å¯èƒ½çš„çœç•¥æœ‰å…³<code>JS</code>çš„æŠ€æœ¯ç»†èŠ‚(è™½ç„¶è¿˜æ˜¯å¼ºåŠ›æ¨èä½ ä»¬ç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹<code>JavaScript</code>)ï¼Œå¸®åŠ©ä½ ä»¬åªè¦ç¨å¾®æ”¹åŠ¨å‡ ä¸ªç‰¹å®šçš„å€¼å°±èƒ½å¤Ÿå®ç°ä½ ä»¬è‡ªå·±éœ€è¦çš„<code>JS</code>è„šæœ¬</li>
<li>æœ‰ä¸€å®šçš„<code>JS</code>åŸºç¡€æˆ–æ’ä»¶ç¼–å†™åŸºç¡€çš„äººç¾¤ï¼Œæˆ‘ä¼šç®€è¦çš„ä»‹ç»<code>PlaceholderAPI JSæ‰©å±•</code>çš„çµé­‚ï¼Œ<code>BukkitPlayer</code>ä¸<code>BukkitServer</code>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/05/08/mc-PAPIJS/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2020/03/29/%E5%88%A9%E7%94%A8IDEA%E4%B8%8EMaven%E7%AE%80%E5%8C%96%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/03/29/%E5%88%A9%E7%94%A8IDEA%E4%B8%8EMaven%E7%AE%80%E5%8C%96%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/" class="post-title-link" itemprop="url">åˆ©ç”¨IDEAä¸Mavenç®€åŒ–æ’ä»¶å¼€å‘æµç¨‹</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-03-29 16:39:15" itemprop="dateCreated datePublished" datetime="2020-03-29T16:39:15+00:00">2020-03-29</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/MineCraft/" itemprop="url" rel="index"><span itemprop="name">MineCraft</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ä½¿ç”¨IntelliJ-IDEA-amp-Mavenå¼€å‘æ’ä»¶"><a href="#ä½¿ç”¨IntelliJ-IDEA-amp-Mavenå¼€å‘æ’ä»¶" class="headerlink" title="ä½¿ç”¨IntelliJ IDEA&amp;Mavenå¼€å‘æ’ä»¶"></a>ä½¿ç”¨IntelliJ IDEA&amp;Mavenå¼€å‘æ’ä»¶</h1><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ä¸çŸ¥é“å„ä½å¼€å‘æ’ä»¶ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆIDEï¼Œeclipse? NetBeans?è¿˜æ˜¯IDEA?ç›¸ä¿¡å„ä½åº”è¯¥å¯¹JetBrainså…¨å®¶æ¡¶æœ‰æ‰€è€³é—»ï¼Œè¿™ä¹Ÿæ˜¯(æˆ‘è‡ªè®¤ä¸º)ç›®å‰æœ€å¥½çš„Java IDEï¼Œå…¶æ‹¥æœ‰ä¸°å¯Œçš„æ’ä»¶ï¼Œå…·æœ‰æå¼ºçš„å¯æ‰©å±•æ€§ï¼Œè€Œä¸”è¿˜æœ‰å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥è®©ç¨‹åºå‘˜çš„ç”Ÿæ´»æ›´åŠ ç¾å¥½ã€‚ä¸ºäº†æ–¹ä¾¿å„ä½åˆšåˆšæ¥è§¦æ’ä»¶çš„å¼€å‘è€…ï¼ŒèŠ‚çœä»–ä»¬å› ä¸ºä¸ç§°æ‰‹çš„å·¥å…·è€Œæµªè´¹çš„æ—¶é—´ï¼Œæˆ‘å†™ä¸‹äº†è¿™ç¯‡IDEA + Mavenæ•™ç¨‹ï¼Œå› ä¸ºï¼ŒçœŸçš„æ˜¯å¤ªå¥½ç”¨å•¦ï¼</p>
<h3 id="1-æ³¨æ„äº‹é¡¹"><a href="#1-æ³¨æ„äº‹é¡¹" class="headerlink" title="1. æ³¨æ„äº‹é¡¹"></a>1. æ³¨æ„äº‹é¡¹</h3><ul>
<li>æœ¬æ•™ç¨‹å¹¶ä¸åŒ…å«å…·ä½“çš„<code>Java</code>è¯­æ³•æ•™å­¦ï¼Œä½†ç†è®ºä¸Šä¸ä¼š<code>Java</code>ä¹Ÿèƒ½å¤Ÿçœ‹æ‡‚(ä½†æ˜¯çœ‹æ‡‚äº†ä¹Ÿæ²¡å•¥ç”¨å§233)<ul>
<li><code>Java</code>åœ¨çº¿å­¦ä¹ ï¼š<a target="_blank" rel="noopener" href="https://www.runoob.com/java/java-tutorial.html">https://www.runoob.com/java/java-tutorial.html</a></li>
</ul>
</li>
<li>è¯·ä¸è¦ä¸æˆ‘äº‰è®ºå“ªä¸€ä¸ª IDE æ›´å¥½ç”¨ï¼Œè¿™æ²¡æœ‰æ„ä¹‰ï¼Œçº¯å±æµªè´¹æ—¶é—´</li>
<li>æœ¬æ•™ç¨‹çš„ç›®æ ‡ä¸ºæ•™ä¼šå„ä½å¦‚ä½•ä½¿ç”¨ IDEA é…åˆ Maven ä»å¤´å¼€å§‹æ‰“åŒ…å‡ºä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„æ’ä»¶ï¼Œå…¶ä¸­ä¼šå¯èƒ½ä¼šç©¿æ’ä¸€äº›å…¶ä»–çŸ¥è¯†çš„æ•™å­¦ï¼Œå„ä½å¯ä»¥å‚è€ƒ</li>
<li>ä¸ºäº†æµ…æ˜¾æ˜“æ‡‚å¾ˆå¤šä¸œè¥¿å¯èƒ½ä¸ä¼šè®²çš„å¾ˆå…·ä½“ï¼Œéƒ¨åˆ†ç»†èŠ‚ä¹Ÿä¼šç®€åŒ–ï¼Œè¯·ä¸è¦æ è°¢è°¢</li>
<li>æœ¬æ•™ç¨‹ä½¿ç”¨ç³»ç»Ÿç¯å¢ƒä¸º<code>Windows 10</code>ï¼Œ<code>Linux</code>ç›¸å…³æ•™ç¨‹æš‚ä¸æä¾›ï¼Œå› ä¸ºæœ¬æ•™ç¨‹ç»å¤§å¤šæ•°éƒ¨åˆ†éƒ½æ˜¯å¯¹äºä»»æ„æ“ä½œç³»ç»Ÿé€šç”¨çš„ï¼›å°‘éƒ¨åˆ†(ä¾‹å¦‚ç¯å¢ƒå˜é‡é…ç½®)ï¼Œæˆ‘ç›¸ä¿¡æœ‰èƒ½åŠ›ä½¿ç”¨<code>Linux</code>è¿›è¡Œå¼€å‘çš„äººä¸€å®šå¯ä»¥è‡ªå·±å»å®Œæˆ
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/03/29/%E5%88%A9%E7%94%A8IDEA%E4%B8%8EMaven%E7%AE%80%E5%8C%96%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.go2mc.net/2018/10/04/CPPStudy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ruby">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ruby's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/10/04/CPPStudy/" class="post-title-link" itemprop="url">CPPStudy</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-10-04 12:50:14" itemprop="dateCreated datePublished" datetime="2018-10-04T12:50:14+00:00">2018-10-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming-Language/" itemprop="url" rel="index"><span itemprop="name">Programming Language</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="CPPå­¦ä¹ è®°å½•"><a href="#CPPå­¦ä¹ è®°å½•" class="headerlink" title="CPPå­¦ä¹ è®°å½•"></a>CPPå­¦ä¹ è®°å½•</h1><p>å†™åœ¨å‰é¢:</p>
<p>è¿™å¯èƒ½æ˜¯æˆ‘å†™è¿‡çš„æœ€æ—©çš„ä¸€ç¯‡åšå®¢äº†ï¼ŒåŒæœŸçš„è¿˜æœ‰è®¸å¤šï¼Œä½†æ˜¯å› ä¸ºå†…å®¹è¿‡äºç©ºæ´ï¼Œåœ¨æˆ‘å¤§æ›´æ–°åšå®¢ä¹‹åæ²¡æœ‰æ‰“ç®—ä¿ç•™ï¼Œä¿ç•™è¿™ä¸€ç¯‡çš„åŸå› ä»…ä»…æ˜¯å› ä¸ºåªæœ‰è¿™ä¸€ç¯‡ç¨å¾®å¤Ÿçœ‹â€¦è¿™ç¯‡åšå®¢è®°å½•äº†æˆ‘å­¦ä¹ <code>ã€ŠC++ Primer Plus 6th Editionã€‹</code>çš„è¿‡ç¨‹ï¼Œä¹Ÿç®—æ˜¯æˆ‘èµ°è¿›è®¡ç§‘é¢†åŸŸè¿ˆå‡ºçš„ç¬¬ä¸€æ­¥ï¼Œå› æ­¤æˆ‘è§‰å¾—ä¿ç•™ä¸‹è¿™ä¸€ç¯‡è¿˜æ˜¯æ¯”è¾ƒæœ‰æ„ä¹‰çš„ã€‚</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2018/10/04/CPPStudy/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ruby</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ruby</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
